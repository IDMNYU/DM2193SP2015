YUI.add("signin-helper",function(e){function t(t,n){e.FlickrStorage.store(t,n)}function n(e,n){var r="fave";t(r,e),l(r,n)}function r(e,t){var n="comment";l(n,t)}function i(e,n){var r="share";t(r,e),l(r,n)}function s(e,n){var r="joingroup";t(r,e),l(r,n)}function o(e,n){var r="follow";t(r,e),l(r,n)}function u(t){var n,r,i=[];if(!t)return;if(e.FlickrStorage.hasEntries()){n=e.FlickrStorage.retrieve();for(r in n)a(t,n[r])||i.push(n[r])}return e.FlickrStorage.remove(),i}function a(e,t){var n=t.key,r=t.value;switch(n){case"fave":return f(e,r),!0;case"share":return!1}}function f(e,t){var n=t.id,r=e.getModelRegistry("photo-engagement-models");r.then(function(e){var t=e.proxy(n);t.registry.addAsFave(n)&&t.remoteUpdate()})}function l(t,n){var r,i;n&&n.withPopup?(r=e.config.win.open(c(n),"_blank","height=650,resizable=1,scrollbars=1,location=yes"),i=setInterval(function(){r.closed&&(clearInterval(i),window.location.reload())},1e3)):e.config.win.location=c(n)}function c(t){t=t||{},t.closeWhenDone&&(t.postLoginUrl=e.url("/photo_grease_postlogin.gne",{protocol:!1}));var n=t.postLoginUrl||e.config.win.location.href,r=t.url||e.url("/signin/yahoo/",{protocol:!1});return r+"?redir="+encodeURIComponent(n)}e.FlickrStorage={_storageKey:"flickrStorage",store:function(t,n){try{var r=[];e.StorageHelper.hasEntries(this._storageKey)&&(r=this.retrieve()),r.push({key:t,value:n}),e.StorageHelper.setItem(this._storageKey,JSON.stringify(r))}catch(i){}},retrieve:function(){var t={};try{t=JSON.parse(e.StorageHelper.getItem(this._storageKey))}catch(n){}return t},remove:function(){try{e.StorageHelper.remove(this._storageKey)}catch(t){}},hasEntries:function(){return e.StorageHelper.hasEntries(this._storageKey)}},e.SigninHelper={savePreLoginAction:t,addPendingFave:n,addPendingComment:r,addPendingShare:i,addPendingFollow:o,addPendingJoinGroup:s,checkPendingQueue:u,_redirectToSignin:l,_getSigninUrl:c}},"@VERSION@",{requires:["url","storage-helper"]});
YUI.add("hermes-template-confirmation-dialog",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return'\n<div class="delete-image-dialog-content">\n	<div class="delete-image-image">\n	        <img class="photo-to-delete" />\n	</div>\n</div>\n\n'}function d(e,t){var r="",i,s,o;r+='\n<div class="dialog-content">\n	',i=n["if"].call(e,e.icon,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;return r+='\n	<div class="dialog-description">\n		<div>',o={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e.content,!1,o):h.call(e,"outlet",e.content,!1,o)))+" ",(s=n.deletePhotoConfirmation)?s=s.call(e,{hash:{},data:t}):(s=e.deletePhotoConfirmation,s=typeof s===f?s.apply(e):s),r+=l(s)+"</div>\n	</div>\n</div>\n",r}function v(e,t){var r="",i;return r+='\n		<i class="dialog-icon ',(i=n.icon)?i=i.call(e,{hash:{},data:t}):(i=e.icon,i=typeof i===f?i.apply(e):i),r+=l(i)+'"></i>\n	',r}function m(e,t){var r="",i,s;return r+='\n	<button class="ui-button ui-button-cta ui-dialog-button-confirm"><span>',s={hash:{intlName:"photo-page-scrappy.GO_TO_ORGANIZER"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):h.call(e,"intlMessage",s)))+"</span></button>\n",r}function g(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.showConfirmButton,{hash:{},inverse:c.noop,fn:c.program(9,y,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.showCancelButton,{hash:{},inverse:c.noop,fn:c.program(11,b,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.showAuxiliaryButton,{hash:{},inverse:c.noop,fn:c.program(13,w,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function y(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm ',(i=n.confirmButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.confirmButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.confirmButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.confirmButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}function b(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm ui-dialog-button-cancel ',(i=n.cancelButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.cancelButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.cancelButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.cancelButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}function w(e,t){var r="",i;return r+='\n		<button class="ui-button ui-button-cta ui-dialog-button-confirm auxiliary-confirmation ',(i=n.auxiliaryButtonClass)?i=i.call(e,{hash:{},data:t}):(i=e.auxiliaryButtonClass,i=typeof i===f?i.apply(e):i),r+=l(i)+'"><span>',(i=n.auxiliaryButtonLabel)?i=i.call(e,{hash:{},data:t}):(i=e.auxiliaryButtonLabel,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span></button>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="dialog-title">\n		<h3>',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.title,a):h.call(t,"renderTrustedMarkup",t.title,a)))+'</h3>\n		<i class="cancel-confirmation ui-dialog-button-close"></i>\n</div>\n\n',u=n["if"].call(t,t.deletePhotoConfirmation,{hash:{},inverse:c.program(3,d,i),fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n\n",u=n["if"].call(t,t.organizrLink,{hash:{},inverse:c.program(8,g,i),fn:c.program(6,m,i),data:i});if(u||u===0)s+=u;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/confirmation-dialog",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("model-proxy",function(e){e.getModelProxyConstructor=function(t){function r(e){return function(){var n=Array.prototype.slice.call(arguments,0);return n.unshift(this.id),t[e].apply(t,n)}}var n;return n=function(e){this.id=e,this.registry=t,this.isModel=!0},n.prototype={},e.getModelProxyConstructor.skipList.forEach(function(e){n.prototype[e]=function(){var t="[ModelProxy] The registry method `"+e+"` isn't exposed on the model, because it should be called via the registry.";throw this.registry.appContext.warn(t),new Error(t)}}),e.Object.each(t,function(t,i){if(n.prototype[i])return;if(i.indexOf("_")===0)return;if(!e.Lang.isFunction(t))return;if(Object.keys(t.prototype).length>0)return;n.prototype[i]=r(i)},this,!0),n},e.getModelProxyConstructor.skipList=["add","get","load","proxy","remoteRead","remoteCreate","attributeSearch","removeAll","getCount","serialize","deserialize"]},"@VERSION@",{requires:[]});
YUI.add("paged-collection",function(e){function t(t){var n={page:1,perPage:0,pageContent:[]};return t?(t instanceof Array&&(t={pageContent:t}),t=e.merge(n,t),t):(e.Flog.warn("No pageData sent to PagedCollection; aborting."),null)}e.PagedCollection=function(e,t,n,r){this.constructor.superclass.constructor.call(this,e,t,n),r&&(r instanceof Array&&(r={pageContent:r,page:1,perPage:r.length}),r.totalPages&&(this.totalPages=r.totalPages),r.totalItems&&(this.totalItems=r.totalItems),this.fetchedStart=!!r.fetchedStart,this.fetchedEnd=!!r.fetchedEnd,this.addPage(r))},e.extend(e.PagedCollection,e.FlickrCollection,{getPage:function(t){var n,r,i,s,o,u,a;if(!t||!t.page||!t.perPage||t.forceAPICall)t||(t={}),s=!0;else{u=this.totalPages&&t.page>=this.totalPages,a=this.totalItems&&r>=this.totalItems,n=t.perPage*(t.page-1),r=Math.min(t.perPage*t.page,this.totalItems);if(!u&&!a||!this.fetchedEnd)for(i=n;i<r;i++)if(typeof this._data[i]=="undefined"){s=!0;break}}return s?(t.id=this.id,t.isCollection=!0,o=this.registry.attributes[this.attrName].pageFetch,o.fetchParams&&(t=e.merge(t,o.fetchParams)),e.FlickrCollection.executeFetch(t,this.registry,this.attrName,o.listFetcher)):e.when(this._data.slice(n,r))},addPage:function(e){var t=e.perPage*(e.page-1),n=t+Math.min(e.pageContent.length,e.perPage),r,i=0;if(e.forceAppend)this._data=this._data.concat(e.pageContent);else if(this._data.length<=t)this._data.length=t,this._data=this._data.concat(e.pageContent);else{this._data.length<n&&(this._data.length=n);for(r=t;r<n;r++)this._data[r]=e.pageContent[i],i++}e.totalPages&&(this.totalPages=e.totalPages,e.page>=this.totalPages&&(this.fetchedEnd=!0)),e.totalItems&&(this.totalItems=e.totalItems,this._data.length>=e.totalItems&&(this.fetchedEnd=!0)),this.fetchedStart=this._data&&typeof this._data[0]!="undefined"},removePage:function(e){},getPageOf:function(t,n){n||(e.Flog.warn("`perPage` must be specified; defaulting to 50."),n=50);var r=this.find(t,!0);return r?Math.floor(r.index/n)+1:-1},getNextIncompletePage:function(e){var t=e.page*(e.perPage-1),n=Math.floor(this._data.length/e.perPage)+1;for(t;t<this._data.length;t++)if(!this._data[t]){n=Math.floor(t/e.perPage)+1;break}return n},_setValue:function(e){if(e instanceof Array)this.constructor.superclass._setValue.call(this,e);else{e=t(e);if(!e)return;e.remove?this.removePage(e):this.addPage(e)}}})},"@VERSION@",{requires:["flickr-collection","flog"]});
YUI.add("flickr-model-registry",function(e){function n(t,n,s){return s===!1&&typeof t=="string"&&typeof n=="string"&&(t=t.toLowerCase(),n=n.toLowerCase()),t===n?!0:e.moment.isMoment(t)&&e.moment.isMoment(n)?t.diff(n)===0:e.Lang.isArray(t)&&e.Lang.isArray(n)&&r(t,n)?!0:e.Lang.isObject(t,!0)&&e.Lang.isObject(n,!0)&&i(t,n)?!0:!1}function r(t,r){var i=!0;return t.length!==r.length&&(i=!1),i&&e.Array.some(t,function(e,t){if(!n(r[t],e))return i=!1,!0}),i}function i(t,r){var i=!0;return e.Object.size(t)!==e.Object.size(r)&&(i=!1),i&&e.Object.some(t,function(e,t){if(!r.hasOwnProperty(t)||!n(r[t],e))return i=!1,!0}),i&&e.Object.some(r,function(e,r){if(!t.hasOwnProperty(r)||!n(t[r],e))return i=!1,!0}),i}function s(t){var n=t;return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Array.prototype?(n=t.slice(),typeof t.hasMinBoundary!="undefined"&&(n.hasMinBoundary=t.hasMinBoundary),typeof t.hasMaxBoundary!="undefined"&&(n.hasMaxBoundary=t.hasMaxBoundary)):Object.getPrototypeOf(t)===Object.prototype&&(n={},e.Object.each(t,function(e,t){n[t]=e},this))),n}e.Models={};var t=e.FlickrModelRegistry=function(t){this.appContext=t,this.attributes=this.attributes||{},this.attributes.id={writeOnce:"initOnly",setter:function(t){return e.Lang.isString(t)||(e.Lang.isNumber(t)?t+="":(e.Flog.warn("`id` falling back to a Y.guid",t,this.name),t=e.guid())),t}},this._setDefaultRemoteMethods(),this._validateAttributes(),this._data={},this._dataSize=0,this._subscribers=[],this.hasWeakSubscribers=!1,this._chainedEvents={},this._derivedCache=undefined,this._unsavedModels={}};t.prototype={attributeSearch:function(t){var r=[];return t.id?r.push(t.id):e.Object.each(this._data,function(i,s){var o=!0;e.Object.some(t,function(e,t){if(!n(e,i[t],!1))return o=!1,!0}),o&&r.push(s)}),r},load:function(t,n){var r=this,i,s;return n||(n={}),e.Lang.isObject(t,!0)?(i=this.attributeSearch(t)[0],n=e.merge(t,n||{})):(i=t,n=e.merge({id:i},n)),i&&this.exists(i)?e.when(i):(this._fetchPromises||(this._fetchPromises={}),s=i||JSON.stringify(n),this._fetchPromises[s]?this._fetchPromises[s]:(this._fetchPromises[s]=this.remoteRead(n).then(function(){var e=i,n,o;i||(n=r.attributeSearch(t),n.length>0&&(e=n[0])),delete r._fetchPromises[s];if(e&&r.exists(e))return e;throw o=new Error("["+r.name+"] Model ID is missing after fetching."),o.getModelFailure=!0,o}),this._fetchPromises[s]))},get:function(e,t){return this.load(e,t).then(this.proxy.bind(this))},add:function(t,n,r){var i;if(!e.Lang.isObject(t,!0)||e.Lang.isArray(t)){e.Flog.warn("`add` requires an object",this.name,t);return}return typeof n=="undefined"&&(n=!1),i=this.attributes.id.setter.apply(this,[t.id,undefined]),this._data[i]?e.Flog.warn("Attempt to add a model that is already in the registry.",this.name,i):(this._data[i]={},this._dataSize++,this._queueEvent("modelsAdded",{id:i}),n?this._data[i]=t:Object.keys(this.attributes).forEach(function(e){var n=this.attributes[e],s=t[e];n.readOnly||this.setValue(i,e,s,!0,r)},this)),this.proxy(i)},remove:function(e){if(!this.exists(e))return;delete this._data[e],this._dataSize--,this._removeChainedEvents(e),this._removeEventSubscribers(e),this._queueEvent("modelsRemoved",{id:e})},removeAll:function(){e.Object.each(this._data,function(e,t){this.remove(t)},this)},_removeChainedEvents:function(t){var n;this._chainedEvents[t]&&(e.Object.each(this._chainedEvents[t],function(t,r){n=this.attributes[r],n&&(n.isModel?t.detach():(n.isListProxy||n.isCollection)&&e.Array.each(t,function(e){e.detach&&e.detach()}))},this),delete this._chainedEvents[t])},_removeEventSubscribers:function(t){var n=[];this._subscribers.length&&(e.Array.each(this._subscribers,function(e,r){e.id===t&&n.push(r)},this),e.Array.each(n,function(e){this._subscribers.splice(e,1)},this))},proxy:function(t){return this._ModelProxy||(this._ModelProxy=e.getModelProxyConstructor(this)),new this._ModelProxy(t)},getValue:function(t,n,r){var i,o,u;if(!t||!n){e.Flog.warn("`getValue` requires two arguments.",this.name,t,n);return}if(!this.exists(t)){e.Flog.warn("`getValue` called for an id that doesn't exist in the registry.",this.name,t,n);return}o=this.attributes[n];if(!o){e.Flog.warn("`getValue` called for an attribute that isn't defined: `"+n+"`.",this.name,t,n);return}return o.isListProxy?i=new e.ListProxy(this,t,n):(i=this._data[t][n],typeof i=="undefined"&&(i=this.getDefaultValue(t,n)),u=o.getter,!r&&u&&(i=u.apply(this,[i,t])),i=s(i)),i},setValue:function(t,r,i,o,u){var a,f,l,c,h,p,d;if(!t||!r||arguments.length<3){e.Flog.warn("`setValue` requires three arguments.",this.name,t);return}if(!this.exists(t)){e.Flog.warn("`setValue called for an id that is not in the registry.",this.name,t);return}a=this.attributes[r];if(!a){e.Flog.warn("Attribute `"+r+"` is not present in the attributes list.",this.name,t);return}if(a.readOnly){e.Flog.warn("Attribute `"+r+"` is readOnly.",this.name,t);return}if(a.writeOnce==="initOnly"&&!o){e.Flog.warn("Attribute `"+r+"` can only be set during initialization.",this.name,t);return}if(a.writeOnce===!0&&this._data[t][r]){e.Flog.warn("Attribute `"+r+"` can only be set once.",this.name,t);return}l=this.getValue(t,r),c=this._data[t][r],a.isListProxy&&(l=c);if(!u&&a.validator){p=a.validator;if(!e.Lang.isFunction(p)){e.Flog.warn("Attribute `"+r+"` has an invalid validator.",this.name,a.validator);return}if(!p.apply(this,[i,t])){e.Flog.info("Attribute `"+r+"` validation failed.",this.name,t,i);return}}i=s(i),!u&&a.setter&&(i=a.setter.apply(this,[i,t])),a.isListProxy&&!e.Lang.isArray(i)&&(i=[]),a.isCollection&&(i?i instanceof e.PagedCollection||(l?(c=l.getList(),l._setValue(i),i=l):(c=null,i=new e.PagedCollection(this,t,r,i))):i=new e.PagedCollection(this,t,r));if(!this._isDifferentValue(t,r,i,l)){!o;return}if(a.isModel)if(!e.Lang.isObject(i)||!i.isModel){e.Flog.warn("Attribute `"+r+"` must be a ModelProxy instance.",this.name,t);return}o||(f=this._getAttributeValuesDerivedBy(t,r)),this._data[t][r]=i,a.isListProxy&&i&&(i.hasMinBoundary&&this.getValue(t,r).setMinBoundary(),i
.hasMaxBoundary&&this.getValue(t,r).setMaxBoundary()),(a.isModel||a.isListProxy||a.isCollection)&&this._chainEvents(t,r),o||(h=this.getValue(t,r),!a.isListProxy&&!a.isCollection&&this._setUnsaved(t,r,h,l,c),d={id:t,attrName:r,prevVal:l,newVal:h},a.isListProxy?d.listDiff=this._calcListDiff(h,l):a.isCollection&&(d.listDiff=this._calcListDiff(h,c)),this._queueEvent("valuesChanged",d),e.Object.size(f)&&e.Object.each(f,function(e,i){var s=this.getValue(t,i);if(!n(s,e)){d={id:t,attrName:i,prevVal:e,newVal:s,derivedBy:[r]};if(this.attributes[i].isListProxy||this.attributes[i].isCollection)d.listDiff=this._calcListDiff(s,e);this._queueEvent("valuesChanged",d)}},this))},setValues:function(t,n){var r={};n.id===t&&delete n.id,e.Object.each(n,function(e,n){r[n]=this.setValue(t,n,e)},this)},revertValue:function(e,t){this._unsavedModels[e]&&typeof this._unsavedModels[e][t]!="undefined"&&this.setValue(e,t,this._unsavedModels[e][t].lastSavedValRaw)},exists:function(e){return!!this._data[e]},addOrUpdate:function(t,n){var r;this.exists(t)?(r=e.merge(n),delete r.id,this.setValues(t,r)):this.add(n)},hasAttribute:function(e){return!!this.attributes[e]},toJSON:function(e){var t={},n,r;if(e)for(n in this.attributes)t[n]=this.getValue(e,n),t[n]&&(this.attributes[n].isModel||this.attributes[n].isListProxy||this.attributes[n].isCollection)&&(t[n]=t[n].toJSON());else for(r in this._data)t[r]=this.toJSON(r);return t},on:function(t,n,r,i){var s;return t||(t=null),s={eventName:n,fn:r,id:t,weak:i},this._subscribers.push(s),i&&(this.hasWeakSubscribers=!0),{detach:function(){var t=e.Array.indexOf(this._subscribers,s);this._subscribers.splice(t,1)}.bind(this)}},removeWeakSubscribers:function(){var e=this._subscribers.length;if(e)while(e--)this._subscribers[e].weak&&this._subscribers.splice(e,1);this.hasWeakSubscribers=!1},getCount:function(){return this._dataSize},getDefaultValue:function(e,t){var n,r;return n=this.attributes[t],typeof n.defaultFn=="function"&&(r=n.defaultFn.call(this,e)),typeof r=="undefined"&&typeof n.defaultValue!="undefined"&&(r=n.defaultValue),r},_isDifferentValue:function(e,t,r,i){var s=this.attributes[t],o=s.getter;o&&(r=o.apply(this,[r,e]));if(typeof s.isListProxy!="undefined"&&s.isListProxy&&typeof i!="undefined"){if(r.hasMaxBoundary!==(typeof i.hasMaxBoundary!="undefined"&&i.hasMaxBoundary)||r.hasMinBoundary!==(typeof i.hasMinBoundary!="undefined"&&i.hasMinBoundary))return!0}else if(s.isCollection)return!0;return n(r,i)?!1:!0},_calcListDiff:function(t,n){var r,i,s,o,u={added:null,removed:null};return t instanceof e.ListProxy||t instanceof e.PagedCollection?r=t.getList():r=t,n instanceof e.ListProxy||n instanceof e.PagedCollection?i=n.getList():i=n,s=i.reduce(function(e,t){return t&&t.id&&(e[t.id]=!0),e},{}),o=r.reduce(function(e,t){return t&&t.id&&(e[t.id]=!0),e},{}),u.added=r.filter(function(e){return e&&!s[e.id]}),u.removed=i.filter(function(e){return e&&!o[e.id]}),u},_getAttributesDerivedBy:function(t){return this._derivedCache||(this._derivedCache={},e.Object.each(this.attributes,function(t,n){t.derivedBy&&e.Lang.isArray(t.derivedBy)&&e.Array.each(t.derivedBy,function(e){this._derivedCache[e]||(this._derivedCache[e]=[]),this._derivedCache[e].push(n)},this)},this)),this._derivedCache[t]},_getAttributeValuesDerivedBy:function(t,n){var r=this._getAttributesDerivedBy(n),i={};return r&&r.length&&e.Array.each(r,function(e){i[e]=this.getValue(t,e)},this),i},_queueEvent:function(t,n){var r;this._eventQueue||(this._eventQueue=[]),r=this._eventQueue,r.push({type:t,data:n}),this._eventPending||(this._eventPending=!0,setTimeout(function(){var t={};this._eventPending=!1,delete this._eventQueue,e.Array.each(r,function(e){var n=e.type,r=e.data,i=r.id;switch(n){case"modelsAdded":case"modelsRemoved":t[n]=t[n]||{},t[n][i]=r;break;case"valuesChanged":if(t.valuesChanged&&t.valuesChanged[i]&&t.valuesChanged[i][r.attrName]&&t.valuesChanged[i][r.attrName].newVal){t.valuesChanged[i][r.attrName].newVal=r.newVal,t.valuesChanged[i][r.attrName].derivedBy&&r.derivedBy&&(t.valuesChanged[i][r.attrName].derivedBy=t.valuesChanged[i][r.attrName].derivedBy.concat(r.derivedBy)),t.valuesChanged[i][r.attrName].chained&&!r.chained&&delete t.valuesChanged[i][r.attrName].chained;break}t.valuesChanged=t.valuesChanged||{},t.valuesChanged[i]=t.valuesChanged[i]||{},t.valuesChanged[i][r.attrName]=r}}),e.Object.each(t,function(e,t){this._fireEvent(t,e)},this)}.bind(this),0))},_fireEvent:function(t,n){e.Array.each(this._subscribers,function(e){e.eventName===t&&(e.id?n[e.id]&&e.fn.call(undefined,n[e.id]):e.fn.call(undefined,n))})},_chainEvents:function(t,n){var r=this.attributes[n],i,s;this._chainedEvents[t]=this._chainedEvents[t]||{};if(r.isModel)this._chainedEvents[t][n]&&this._chainedEvents[t][n].detach(),s=this.getValue(t,n),this._chainedEvents[t][n]=s.on("valuesChanged",function(e){this._queueChainedEvent(t,n)}.bind(this));else if(r.isListProxy||r.isCollection)this._chainedEvents[t][n]&&e.Array.each(this._chainedEvents[t][n],function(e){e.detach()}),this._chainedEvents[t][n]=[],i=this.getValue(t,n),e.Array.each(i.getList(),function(e){e&&this._chainedEvents[t][n].push(e.on("valuesChanged",function(e){this._queueChainedEvent(t,n)}.bind(this)))},this)},_queueChainedEvent:function(t,n){var r=this.getValue(t,n),i;this._queueEvent("valuesChanged",{id:t,attrName:n,prevVal:r,newVal:r,chained:!0}),i=this._getAttributeValuesDerivedBy(t,n),e.Object.size(i)&&e.Object.each(i,function(e,r){this._queueEvent("valuesChanged",{id:t,attrName:r,newVal:e,derivedBy:[n],chained:!0})},this)},_deleteUnsaved:function(t,n){this._unsavedModels[t]&&this._unsavedModels[t][n]&&(delete this._unsavedModels[t][n],e.Object.size(this._unsavedModels[t])===0&&delete this._unsavedModels[t])},_setUnsaved:function(e,t,r,i,s){this._unsavedModels[e]&&this._unsavedModels[e][t]?n(r,this._unsavedModels[e][t].lastSavedVal)&&this._deleteUnsaved(e,t):(this._unsavedModels[e]=this._unsavedModels[e]||{},this._unsavedModels[e][t]={lastSavedVal:i,lastSavedValRaw:s})},_validateAttributes
:function(){var t,n;t=["setter","getter","validator","defaultValue","defaultFn","derivedBy","readOnly","writeOnce","isModel","serialize","deserialize"],n=["isListProxy","isCollection","pageFetch","contextFetch","rangeFetch"],e.Object.each(this.attributes,function(r,i){e.Object.each(r,function(s,o){r.isListProxy||r.isCollection?e.Array.indexOf(n,o)===-1&&e.Flog.warn("Unknown property `"+o+"` on collection attribute `"+i+"`",this.name):e.Array.indexOf(t,o)===-1&&e.Flog.warn("Unknown property `"+o+"` on attribute `"+i+"`",this.name)},this)},this)},_setDefaultRemoteMethods:function(){this.remote=this.remote||{},this.remote.create||(this.remote.create=function(t){return e.Flog.error("[flickr-model-registry] `remote.create` was called without being implemented.",this.name,t),e.Promise.reject()}),this.remote.read||(this.remote.read=function(t){Object.keys(this.attributes).some(function(e){var t=this.attributes[e];if(e!=="id"&&!t.readOnly&&!t.isListProxy&&!t.isCollection&&!t.defaultValue&&!t.defaultFn)return!0},this),typeof t!="object"&&(t={id:t});var n={id:t.id};return this.add(n),e.Promise.resolve(n)}),this.remote.update||(this.remote.update=function(t,n){return e.Flog.error("[flickr-model-registry] `remote.update` was called without being implemented.",this.name,arguments),e.Promise.reject()}),this.remote["delete"]||(this.remote["delete"]=function(t){return e.Flog.error("[flickr-model-registry] `remote.delete` was called without being implemented.",this.name,arguments),e.Promise.reject()})},remoteCreate:function(e){return this.remote.create.call(this,e)},remoteRead:function(e){return this.remote.read.call(this,e)},remoteUpdate:function(t){var n={},r=this;return this._unsavedModels[t]&&e.Object.each(this._unsavedModels[t],function(e,r){n[r]={newVal:this.getValue(t,r),prevVal:e.lastSavedVal}},this),e.Object.size(n)>0?this.remote.update.call(this,t,n).then(function(e){return r._unsavedModels={},e}):e.Promise.resolve()},remoteBatchUpdate:function(e,t){return this.remote.batchUpdate.call(this,e,t)},remoteDelete:function(e){var t=this;return this.remote["delete"].call(this,e).then(function(){t.remove(e)})},getListPageByContinuation:function(t,n){var r=this,i=r.appContext,s,o,u,a,f,l,c,h,p,d,v="0",m="-1",g=e.APIHelper.request.getRebootPhotoExtras();switch(r.name){case"photo-groups-models":s="group-pool-models",o="groups",u="flickr.photos.getGroups",a="groups.group",g+=","+e.APIHelper.request.getRebootGroupExtras();break;case"photo-sets-models":s="set-models",o="sets",u="flickr.photos.getSets",a="sets.set";break;case"photo-galleries-models":s="gallery-models",o="galleries",u="flickr.photos.getGalleries",a="galleries.gallery"}return u?r.exists(t)?(r.continuationKeys=r.continuationKeys||{},r.getMorePromises=r.getMorePromises||{},l=r.continuationKeys[t]||v,l===m?e.Promise.resolve({newItems:[],loadedAll:!0}):(l===v&&(n+=r.getValue(t,o).getList().length),f={photo_id:t,extras:g,primary_photo_extras:"url_sq, url_t, url_s, url_m",continuation:l,per_page:n},h=t+"_"+l,p=r.getMorePromises[h],p?p:(d={apiResponse:i.callAPI(u,f,!0),contextRegistry:i.getModelRegistry(s),personRegistry:i.getModelRegistry("person-models")},r.name==="photo-groups-models"&&(d.groupRegistry=i.getModelRegistry("group-models")),r.getMorePromises[h]=(new e.FlickrPromise(d)).then(function(n){var i=[],s=n.apiResponse,u=n.contextRegistry,f=n.personRegistry,l=n.groupRegistry,p,d,v;return d=a.split(".").reduce(function(t,n){return e.Lang.isObject(t)?t[n]:undefined},s),d&&(e.Array.each(d,function(t){e.APIHelper.response.addContextToRegistry(t,u,f,l),i.push(u.proxy(t.id))}),i.length&&(v=r.getValue(t,o).getList().map(function(e){return e.getValue("id")}),i=i.filter(function(e){return v.indexOf(e.getValue("id"))===-1}),i.length&&r.getValue(t,o).appendToListMulti(i))),c=s[o].continuation,typeof c=="undefined"?c=m:e.Lang.isNumber(c)&&(c+=""),p=c===m,r.continuationKeys[t]=c,delete r.getMorePromises[h],{newItems:i,loadedAll:p}},function(e){throw delete r.getMorePromises[h],e}),r.getMorePromises[h]))):e.Promise.reject("[api-helper] getListPageByContinuation was called for an ID that isn't in the registry: "+t):e.Promise.reject("[api-helper] getListPageByContinuation was called without an invalid registry type: "+r.name)},getBuriedValue:function(e,t){var n,r={};return n=this.getValue(e,t),n&&n.payload&&(r=n.payload),r},setBuriedValue:function(e,t,n,r){return this.setValue(e,t,{payload:n},r)}},e.mix(t.prototype,e.Localizable)},"@VERSION@",{requires:["flickr-promise","model-proxy","list-proxy","moment","paged-collection","localizable","flog"]});
YUI.add("hermes-lang-models",function(e,t){e.Intl.add("hermes/models","en-US",{YOUR_PHOTOSTREAM:["Your photostream"],USER_PHOTOSTREAM:["${name}","'s photostream"],USER_PHOTOS:["${name}","'s photos"],PHOTOSTREAM:["Photostream"],YOUR_FAVORITES:["Your favorites"],USER_FAVORITES:["${name}","'s favorites"],FAVORITES:["Favorites"],ZERO_PHOTOS:["0 photos"],ONE_PHOTO:["1 photo"],MULTIPLE_PHOTOS:["${photos}"," photos"],PLURAL_PHOTOS:[{type:"plural",valueName:"count",options:{one:"1 photo",other:"${#} photos"}}],ONE_VIDEO:["1 video"],ONE_PHOTO_AND_ONE_VIDEO:["1 photo and 1 video"],MULTIPLE_PHOTOS_AND_ONE_VIDEO:["${photos}"," photos and 1 video"],MULTIPLE_VIDEOS:["${videos}"," videos"],ONE_PHOTO_AND_MULTIPLE_VIDEOS:["1 photo and ","${videos}"," videos"],MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS:["${photos}"," photos and ","${videos}"," videos"],PHOTO_LIST:["Photo list"],EXPlORE_TITLE:["Explore ","${id}"],BAD_DATE_TYPE:["Bad date type"],ZERO_ITEMS:["0 items"],ONE_ITEM:["1 item"],MULTIPLE_ITEMS:["${items}"," items"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-shared-entity",function(e,t){e.Intl.add("hermes/shared-entity","en-US",{USERNAME_HAS_SHARED_PHOTOS_ONLY:["${username}"," has shared ",{type:"plural",valueName:"photoCount",options:{one:"1 photo",other:"${#} photos"}}," with you!"],USERNAME_HAS_SHARED_VIDEOS_ONLY:["${username}"," has shared ",{type:"plural",valueName:"videoCount",options:{one:"1 video",other:"${#} videos"}}," with you!"],USERNAME_HAS_SHARED_PHOTOS_VIDEOS:["${username}"," has shared ",{type:"plural",valueName:"photoCount",options:{one:"1 photo",other:"${#} photos"}}," ",{type:"plural",valueName:"videoCount",options:{one:"and 1 video",other:"and ${#} videos"}}," with you!"],OWNER_HAS_SHARED_PHOTOS_ONLY:["You have shared ",{type:"plural",valueName:"photoCount",options:{one:"1 photo",other:"${#} photos"}},"."],OWNER_HAS_SHARED_VIDEOS_ONLY:["You have shared ",{type:"plural",valueName:"videoCount",options:{one:"1 video",other:"${#} videos"}},"."],OWNER_HAS_SHARED_PHOTOS_VIDEOS:["You have shared ",{type:"plural",valueName:"photoCount",options:{one:"1 photo",other:"${#} photos"}}," ",{type:"plural",valueName:"videoCount",options:{one:"and 1 video",other:"and ${#} videos"}},"."],VIEW_YOUR_SHARING_HISTORY:["View your sharing history"]})},"@VERSION@",{requires:["intl"]});
YUI.add("flickr-favorites-add-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photo_id=n.photoId,r.callAPI("flickr.favorites.add",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-favorites-add"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-favorites-remove-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photo_id=n.photoId,i.user_id=n.userId,r.callAPI("flickr.favorites.remove",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-favorites-remove"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-model-helper",function(e){e.PhotoModelHelper={updateEngagement:function(t,n){var r=[],i;return e.Lang.isObject(n,!0)&&"isFaved"in n&&(i=n.isFaved.newVal?"flickr-favorites-add":"flickr-favorites-remove",r.push(e.ModelUpdaters[i].run({photoId:t},this.appContext))),e.Promise.all(r)},toggleFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved"),r=!n,i="photo-engagement-models",s=t+(r?1:-1);this.setValues(e,{isFaved:r,faveCount:s}),this.name!==i&&this.appContext.getModelRegistry(i).then(function(t){t.exists(e)&&t.toggleFave(e)})},addAsFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved"),r="photo-engagement-models";return n||this.setValues(e,{isFaved:!0,faveCount:t+1}),this.name!==r&&this.appContext.getModelRegistry(r).then(function(t){t.exists(e)&&t.toggleFave(e)}),!n},getLargestSize:function(e,t){return this.getSizeToFit(e,{width:Number.MAX_VALUE,height:Number.MAX_VALUE},t)},getSizeToFit:function(t,n,r){r=r||{};var i=this,s,o=n.width,u=n.height,a=!!r.cropToFit,f=r.includeSquare,l=r.sizes||this.getValue(t,"sizes"),c=r.excludeSizes||["o"],h=r.includeSizes||Object.keys(l),p,d,v;return this._getSizeToFitMemo=this._getSizeToFitMemo||{},s=[t,o,u,a,c.sort().join(""),h.sort().join("")].join("_"),this._getSizeToFitMemo[s]||(e.Object.each(l,function(e,n){var r,i,s,l,m,g;if(e&&c.indexOf(n)===-1&&h.indexOf(n)>-1)if(f||!this.isSizeSquare(n)||this.isPhotoSquare(t)){r=parseInt(e.width,10),i=parseInt(e.height,10),a&&r>=o&&i>=u?s=!0:!a&&(r>=o||i>=u)&&(s=!0),s&&(p?(l=parseInt(p.height,10),i<l&&(p=e)):p=e);if(d){m=parseInt(d.width,10),g=parseInt(d.height,10);if(r>m||i>g)d=e}else d=e}v=p||d},this),this._getSizeToFitMemo[s]=v,this._getSizeToFitMemoTimer||(this._getSizeToFitMemoTimer=setTimeout(function(){delete i._getSizeToFitMemo,delete i._getSizeToFitMemoTimer},1e4))),e.clone(this._getSizeToFitMemo[s],!0)},getSizeIfExact:function(e,t){var n=this.getValue(e,"sizes"),r,i;return Object.keys(n).some(function(e){return e==="o"?!1:(i=n[e],t.height===i.height&&t.width===i.width?(r=i,!0):!1)}),r},isSizeSquare:function(e){var t={sq:"sq",q:"q"};return!!t[e]},isPhotoSquare:function(t){var n;return this._isPhotoSquareMemo=this._isPhotoSquareMemo||{},typeof this._isPhotoSquareMemo[t]!="undefined"?n=this._isPhotoSquareMemo[t]:(n=!0,e.Object.some(this.getValue(t,"sizes"),function(e,t){var r;if(e&&e.width&&e.height&&!this.isSizeSquare(t)){r=parseInt(e.width,10)/parseInt(e.height,10);if(r!==1)return n=!1,!0}},this),this._isPhotoSquareMemo[t]=n),n},attributes:{title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},mediaType:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:"photo"},license:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},isVideo:{readOnly:!0,derivedBy:["mediaType"],getter:function(e,t){var n=this.getValue(t,"mediaType");return n==="video"}},isOwner:{readOnly:!0,derivedBy:["owner"],getter:function(e,t){var n=this.getValue(t,"owner"),r=this.appContext.getViewer();return!!r.signedIn&&n.getValue("id")===r.nsid}},sizes:{},descendingSizes:{readOnly:!0,derivedBy:["sizes"],defaultFn:function(e){var t,n,r=[];this._descendingSizesMemo=this._descendingSizesMemo||{};if(this._descendingSizesMemo[e])return this._descendingSizesMemo[e];t=this.getValue(e,"sizes");for(n in t)r.push(t[n]),r[r.length-1].key=n;return r.sort(function(e,t){return e.width<t.width?1:e.width===t.width?e.height<t.height?1:e.height===t.height?e.key==="o"?-1:1:-1:-1}),this._descendingSizesMemo[e]=r,r}},ascendingSizes:{readOnly:!0,derivedBy:["descendingSizes"],defaultFn:function(e){return this.getValue(e,"descendingSizes").reverse()}},aspectRatio:{readOnly:!0,derivedBy:["descendingSizes","rotation"],defaultFn:function(e){var t=this.getValue(e,"descendingSizes")[0];return t.key==="o"&&this.getValue(e,"rotation")%180!==0?t.height/t.width:t.width/t.height}},needsInterstitial:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canComment:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!0},url:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner");return t?"/photos/"+t.getValue("pathAlias")+"/"+e:undefined}},rotation:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},ownerNsid:{},isFaved:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},faveCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},commentCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},canFave:{readOnly:!0,derivedBy:["is_owner"],getter:function(e,t){return!this.getValue(t,"isOwner")}}}}},"@VERSION@",{requires:["flickr-favorites-add-updater","flickr-favorites-remove-updater"]});
YUI.add("attribute-helpers",function(e){function t(e){if(typeof e=="undefined"||e===null)return!0}function n(n){return t(n)?!0:e.Lang.isString(n)?!0:e.Lang.isNumber(n)?!0:!1}function r(t){return e.Lang.isNumber(t)&&(t=t.toString()),e.Lang.isString(t)?t:undefined}function i(n){return t(n)?!0:[!0,!1].indexOf(n)!==-1?!1:n instanceof Array?!1:(typeof n=="string"&&(n=parseInt(n,10)),typeof n=="object"&&typeof n._d!="undefined"&&(n=n._d),e.moment(n).isValid()?!0:!1)}function s(t){var n=null,r=null;if(e.moment.isMoment(t))return t;if(t&&typeof t=="object"&&t._d){r=e.moment(t),r.isValid()||(r=e.moment(t._d));if(r.isValid())return r}return typeof t=="number"||t===parseInt(t,10).toString()?(n=parseInt(t,10),n.toString().length<=10?r=e.moment(n.toString(),"X"):r=e.moment(n),r):t&&!e.Lang.isBoolean(t)&&e.moment(new Date(t)).isValid()?e.moment(t):undefined}function o(n){return t(n)?!0:(e.Lang.isString(n)&&(n=parseInt(n,10)),e.Lang.isNumber(n)?!0:!1)}function u(t){return e.Lang.isString(t)&&(t=parseInt(t,10)),e.Lang.isNumber(t)?t<0?Math.ceil(t):Math.floor(t):undefined}function a(n){return t(n)?!0:(e.Lang.isString(n)&&(n=parseFloat(n)),e.Lang.isNumber(n)?!0:!1)}function f(t){return e.Lang.isString(t)&&(t=parseFloat(t)),e.Lang.isNumber(t)?t:undefined}function l(n){return t(n)?!0:e.Lang.isBoolean(n)?!0:[0,"0","false"].indexOf(n)>-1?!0:[1,"1","true"].indexOf(n)>-1?!0:!1}function c(e){return[!1,"0",0,"false"].indexOf(e)>-1?!1:[!0,"1",1,"true"].indexOf(e)>-1?!0:undefined}e.AttributeHelpers={validateString:n,coerceString:r,validateInteger:o,coerceInteger:u,validateFloat:a,coerceFloat:f,validateBoolean:l,coerceBoolean:c,validateDate:i,coerceDate:s}},"@VERSION@",{requires:[]});
YUI.add("photo-location-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext).then(function(e){return e},function(){})}},attributes:{geo:{isModel:!0},hasGeo:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("hasGeo"):!1}},latitude:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("latitude"):null}},longitude:{readOnly:!0,derivedBy:["geo"],defaultFn:function(e){var t=this.getValue(e,"geo");return t?t.getValue("longitude"):null}},levels:{},text:{},mostSpecificWoeId:{readOnly:!0,derivedBy:["levels"],defaultFn:function(e){var t=this.getValue(e,"levels"),n;return["neighbourhood","locality","region","county","country","continent"].some(function(e){if(t[e]&&t[e].woeId)return n=t[e].woeId,!0}),n}},staticMaps:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","attribute-helpers"]});
YUI.add("flickr-photos-getLocation-fetcher",function(e,t){"use strict";function n(t,n){var i=t.photo||{},s=i.location||null,o,u=i.staticMaps&&i.staticMaps.staticMap||null,a=i.venues?i.venues.venue:null,f,l=[];return f={id:i.id,levels:{}},s?(o={id:i.id,hasGeo:!0,latitude:s.latitude,longitude:s.longitude},["neighbourhood","locality","region","county","country"].forEach(function(e){if(!s[e])return;f.levels[e]={name:s[e].content||null,woeId:s[e].woeid||null}})):o={id:i.id,hasGeo:!1},n.exists(o.id)||n.add(o),f.geo=n.proxy(o.id),a&&(f.levels.venue={name:a.content||a.address||null,woeId:a.woe_id,source:a.source,venueId:a.id,venueLat:a.latitude,venueLong:a.longitude},a.content&&l.push(a.content),a.city&&l.push(a.city),a.country&&l.push(a.country),f.text=l.join(", ")),f.text||(f.text=r(f.levels)),e.Lang.isArray(u)&&(f.staticMaps={},u.forEach(function(e){f.staticMaps["zoom"+e.zoom]=e})),f}function r(e){var t=[],n,r,i;n=[["venue","locality","region"],["neighbourhood","locality","region"],["locality","region","country"],["county","region","country"]];while(n.length&&t.length<3){r=n.shift(),t=[];while(r.length&&t.length<3)i=r.shift(),e[i]&&e[i].name&&t.push(e[i].name)}return t.join(", ")}function i(n,r){var i=n.id,s={photo_id:i,extras:"venue"},o=this;return e.APIHelper.request.addStaticMapsParams(s),e.Promise.all([r.callAPI("flickr.photos.geo.getLocation",s),r.getModelRegistry("photo-location-models"),r.getModelRegistry("photo-geo-models")]).then(function(e){var t=e[0],n=e[1],r=e[2],i=o.mapResponse(e[0],r);return n.exists(t.photo.id)||n.add(i),i},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-photos-getLocation"]={run:i,mapResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-geo-models","photo-location-models"]});
YUI.add("flickr-contacts-add-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.add",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-add"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-remove-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.remove",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-remove"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-edit-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.edit",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-edit"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-block-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.block",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-block"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-unblock-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.unblock",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-unblock"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("person-relationship-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};if(e.Lang.isObject(n,!0)){i.user_id=t,i.friend=this.getValue(t,"isFriend"),i.family=this.getValue(t,"isFamily"),"isContact"in n&&(n.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(i,this.appContext)));if("isFriend"in n||"isFamily"in n)"isFriend"in n&&(i.friend=n.isFriend.newVal),"isFamily"in n&&(i.family=n.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(i,this.appContext));"isIgnored"in n&&(n.isIgnored.newVal===!0?r.push(e.ModelUpdaters["flickr-contacts-block"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(i,this.appContext)))}return e.Promise.all(r)}},toggleFollowing:function(e){var t=this.getValue(e,"isContact");t?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){var t=this.getValue(e,"isFriend");t?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){var t=this.getValue(e,"isFamily");t?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){var t=this.getValue(e,"isIgnored");t?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var n=this.appContext.getViewer();return!!n&&this.getValue(t,"nsid")===n.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});
YUI.add("flickr-prefs-setSafeSearch-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.prefs.setSafeSearch",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-prefs-setSafeSearch"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("person-preferences-models",function(e){function t(e){t.superclass.constructor.call(this,e)}t.UNIFIED_SEARCH_VIEW_TYPES={justified:"jst",thumbs:"thm",tiles:"til"},t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT=t.UNIFIED_SEARCH_VIEW_TYPES.justified,t.PHOTOSTREAM_VIEW_ORDER_TYPES={dateposted:"dc",datetaken:"dt"},t.PHOTOSTREAM_VIEW_ORDER_DEFAULT=t.PHOTOSTREAM_VIEW_ORDER_TYPES.dateposted,t.PHOTOSTREAM_VIEW_AS_TYPES={me:"me",friend:"fr",family:"fa",ff:"ff","public":"pu"},t.PHOTOSTREAM_VIEW_PREF_MAP={me:"me",fr:"friend",fa:"family",ff:"ff",pu:"public",dc:"dateposted",dt:"datetaken"},t.PHOTOSTREAM_VIEW_AS_DEFAULT=t.PHOTOSTREAM_VIEW_AS_TYPES.public,e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};return e.Lang.isObject(n,!0)&&("safeSearch"in n?(i.safe_search=e.AttributeHelpers.coerceInteger(n.safeSearch.newVal)+1,r.push(e.ModelUpdaters["flickr-prefs-setSafeSearch"].run(i,this.appContext))):"photostreamViewOrderPref"in n||"photostreamViewAsPref"in n?(n.photostreamViewOrderPref&&(i.photostream_view_order_pref=n.photostreamViewOrderPref.newVal),n.photostreamViewAsPref&&(i.photostream_view_as_pref=n.photostreamViewAsPref.newVal),r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))):Object.keys(n).forEach(function(e){i[e]=n[e],r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))})),e.Promise.all(r)}},attributes:{safeSearch:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},unifiedSearchViewPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.UNIFIED_SEARCH_VIEW_TYPES).some(function(e){return t.UNIFIED_SEARCH_VIEW_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT},photostreamViewOrderPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.PHOTOSTREAM_VIEW_ORDER_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_ORDER_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_ORDER_DEFAULT},photostreamViewAsPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.PHOTOSTREAM_VIEW_AS_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_AS_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_AS_DEFAULT}}},{getReadablePrefName:function(e){return t.PHOTOSTREAM_VIEW_PREF_MAP[e]}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-prefs-setSafeSearch-updater","attribute-helpers"]});
YUI.add("person-profile-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{nsid:{readOnly:!0,defaultFn:function(e){return e}},photoCount:{},unreadMessages:{},storageUsed:{},storageTotal:{},coverPhotoUrls:{},location:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher"]});
YUI.add("flickr-groups-join-creator",function(e,t){"use strict";function n(n,r){var i={};return i.group_id=n.groupModel.id,i.accept_rules=n.acceptRules,e.Promise.all([r.callAPI("flickr.groups.join",i)]).then(function(e){var t=e[0];if(t.stat==="ok")return n.groupModel.join(),n.groupModel},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-groups-join"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
