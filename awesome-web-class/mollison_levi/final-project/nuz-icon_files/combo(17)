YUI.add("hermes-template-photo-page-scrappy",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["global-nav-view"],u):a.call(t,"outlet",t["global-nav-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["photo-well-view"],u):a.call(t,"outlet",t["photo-well-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["sub-photo-view"],u):a.call(t,"outlet",t["sub-photo-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["footer-full-view"],u):a.call(t,"outlet",t["footer-full-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["curator-photo-tools-view"],u):a.call(t,"outlet",t["curator-photo-tools-view"],u))),s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-page-scrappy",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-page-right-size-express",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='\n\n<script type="text/javascript">\n\n	\n	(function(){\n\n		\n		var PADDING_HORIZONTAL = 40;\n\n		\n		window.getPhotoWellHeight = function () {\n\n			var minHeight = 500,\n			    winWidth = window.innerWidth,\n			    \n			    winHeight = window.innerHeight - 50,\n			    ratioNarrow = 1,\n			    ratioRegular = 2.3,\n			    ratioTransitional = 2.75,\n			    idealSubphotoHeight = 120,\n			    breakHeightNarrow = (winWidth / ratioNarrow) + idealSubphotoHeight,\n			    breakHeightRegular = (winWidth / ratioRegular) + idealSubphotoHeight,\n			    breakHeightTransitional = winWidth / ratioTransitional,\n			    newPhotoWellHeight;\n\n			\n			if (winHeight > breakHeightNarrow) {\n\n				newPhotoWellHeight = winWidth / ratioNarrow;\n\n			\n			} else if (winHeight > breakHeightRegular) {\n\n				newPhotoWellHeight = winHeight - idealSubphotoHeight;\n\n			\n			} else if (winHeight > breakHeightTransitional) {\n\n				newPhotoWellHeight = winHeight - idealSubphotoHeight + idealSubphotoHeight * (winHeight - breakHeightRegular) / (breakHeightTransitional - breakHeightRegular);\n\n			\n			} else {\n\n				newPhotoWellHeight = winHeight;\n\n			}\n\n			\n			return Math.max(minHeight, Math.round(newPhotoWellHeight));\n\n		}\n\n		\n		function domReady () {\n\n			\n			try {\n\n				\n				if (document.getElementsByClassName("low-res-photo")[0]) {\n\n					var photoWellView = document.getElementsByClassName("photo-well-scrappy-view")[0],\n					    heightController = photoWellView.getElementsByClassName("height-controller")[0],\n					    photoWellMediaView = document.getElementsByClassName("photo-well-media-scrappy-view")[0],\n					    lowResImageElement = photoWellMediaView.getElementsByClassName("low-res-photo")[0],\n					    photoWidth = ',(o=n.photoWidth)?o=o.call(t,{hash:{},data:i}):(o=t.photoWidth,o=typeof o===u?o.apply(t):o),s+=a(o)+",\n					    photoHeight = ",(o=n.photoHeight)?o=o.call(t,{hash:{},data:i}):(o=t.photoHeight,o=typeof o===u?o.apply(t):o),s+=a(o)+",\n					    photoAspectRatio = photoWidth / photoHeight,\n					    photoWellHeight = window.getPhotoWellHeight(),\n					    photoWellMediaViewPadding = {\n					        top: parseInt(getComputedStyle(photoWellMediaView)['paddingTop'].match(/[0-9]+/)[0], 10),\n					        right: PADDING_HORIZONTAL,\n					        bottom: parseInt(getComputedStyle(photoWellMediaView)['paddingBottom'].match(/[0-9]+/)[0], 10),\n					        left: PADDING_HORIZONTAL\n					    },\n					    canvasSize = {\n					        height: photoWellHeight - photoWellMediaViewPadding.top - photoWellMediaViewPadding.bottom,\n					        width: window.innerWidth - photoWellMediaViewPadding.left - photoWellMediaViewPadding.right\n					    };\n\n					"+'\n					heightController.style.height = photoWellHeight + "px";\n\n					'+'\n					if (photoWidth <= canvasSize.width && photoHeight <= canvasSize.height) {\n						lowResImageElement.style.height = photoHeight + "px";\n						lowResImageElement.style.width = photoWidth + "px";\n					} else {\n						'+"\n						if (photoAspectRatio < 1 || Math.round(canvasSize.width / photoAspectRatio) > canvasSize.height) {\n							"+'\n							lowResImageElement.style.height = canvasSize.height + "px";\n							lowResImageElement.style.width = Math.round(canvasSize.height * photoAspectRatio) + "px";\n						} else {\n							'+'\n							lowResImageElement.style.height = Math.round(canvasSize.width / photoAspectRatio) + "px";\n							lowResImageElement.style.width = canvasSize.width + "px";\n						}\n					}\n\n				}\n\n			} catch (e) {\n				'+"\n				if (window.sendRequest) {\n					window.sendRequest('flickr.hermes.photoDimensionCorrectionError', 'There was a JS error when trying to correct a server rendered photo.');\n				}\n			}\n\n		}\n\n		"+"\n		if (document.readyState != 'loading'){\n			domReady();\n		} else {\n			document.addEventListener('DOMContentLoaded', domReady);\n		}\n\n	}());\n\n</script>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-page-right-size-express",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("plugin",function(e,t){function n(t){!this.hasImpl||!this.hasImpl(e.Plugin.Base)?n.superclass.constructor.apply(this,arguments):n.prototype.initializer.apply(this,arguments)}n.ATTRS={host:{writeOnce:!0}},n.NAME="plugin",n.NS="plugin",e.extend(n,e.Base,{_handles:null,initializer:function(e){this._handles=[]},destructor:function(){if(this._handles)for(var e=0,t=this._handles.length;e<t;e++)this._handles[e].detach()},doBefore:function(e,t,n){var r=this.get("host"),i;return e in r?i=this.beforeHostMethod(e,t,n):r.on&&(i=this.onHostEvent(e,t,n)),i},doAfter:function(e,t,n){var r=this.get("host"),i;return e in r?i=this.afterHostMethod(e,t,n):r.after&&(i=this.afterHostEvent(e,t,n)),i},onHostEvent:function(e,t,n){var r=this.get("host").on(e,t,n||this);return this._handles.push(r),r},onceHostEvent:function(e,t,n){var r=this.get("host").once(e,t,n||this);return this._handles.push(r),r},afterHostEvent:function(e,t,n){var r=this.get("host").after(e,t,n||this);return this._handles.push(r),r},onceAfterHostEvent:function(e,t,n){var r=this.get("host").onceAfter(e,t,n||this);return this._handles.push(r),r},beforeHostMethod:function(t,n,r){var i=e.Do.before(n,this.get("host"),t,r||this);return this._handles.push(i),i},afterHostMethod:function(t,n,r){var i=e.Do.after(n,this.get("host"),t,r||this);return this._handles.push(i),i},toString:function(){return this.constructor.NAME+"["+this.constructor.NS+"]"}}),e.namespace("Plugin").Base=n},"3.16.0",{requires:["base-base"]});
YUI.add("ttfp-recorder-plugin",function(e,t){"use strict";function i(e){i.superclass.constructor.apply(this,arguments)}var n="AFT",r="AFT_CL";i.NAME=i.NS="TTFPRecorderPlugin",i.ATTRS={selector:{value:""}},e.extend(i,e.Plugin.Base,{initializer:function(e){this.set("selector",e.selector),this.afterHostMethod("setContainerHTML",this._doAfterSetContainerHTML,this)},destructor:function(){},setSelector:function(e){this.set("selector",e)},testImageResolver:function(t,n,r){return function(i,s){var o=new Image,u=e.guid();window.LH&&r&&window.LH.mark("mark_time_to_load_photo_only_start"+u),o.onload=function(){t.inDoc()||i();if(o.onloadFired){i();return}o.onloadFired=!0;if(window.LH&&r)try{window.LH.mark("mark_time_to_load_photo_only"+u),window.LH.measure("time_to_load_photo_only",{startMark:"mark_time_to_load_photo_only_start"+u,endMark:"mark_time_to_load_photo_only"+u})}catch(s){e.Flog.warn("time to load photo: Missing start mark")}i(n)},o.onerror=function(){s("Failed to load image")},o.src=t.getAttribute("src"),o.complete&&(o.onloadFired=!0,i(n))}},_doAfterSetContainerHTML:function(){var e,t,i,s;s=this.get("host"),e=s.get("container"),s&&s.appContext&&s.appContext.clientMetrics&&e&&(t=e.one(this.get("selector")),i=s.appContext.clientMetrics,t&&(i.setPendingMark(this.testImageResolver(t,n,!0)),i.setPendingMark(this.testImageResolver(t,r)),i.beaconLater()))}}),e.namespace("Plugin.FlickrView").TTFPRecorderPlugin=i},"@VERSION@",{requires:["plugin"]});
YUI.add("hermes-template-error-500",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){return'\n<html lang="en-us">\n<head>\n	<title>Flickr - Photo Sharing!</title>\n	<meta charset="utf-8">\n	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">\n'}function c(e,t){return'\n</head>\n\n<body>\n	<div id="main">\n'}function h(e,t){var r="",i;return r+="\n				<span><b>Error</b>: ",(i=n.message)?i=i.call(e,{hash:{},data:t}):(i=e.message,i=typeof i===u?i.apply(e):i),r+=a(i)+"</span>\n			",r}function p(e,t){var r="",i;return r+="\n				<span><b>Source</b>: ",(i=n.source)?i=i.call(e,{hash:{},data:t}):(i=e.source,i=typeof i===u?i.apply(e):i),r+=a(i)+"</span>\n			",r}function d(e,t){var r="",i;return r+="\n				<span>",(i=n.requestID)?i=i.call(e,{hash:{},data:t}):(i=e.requestID,i=typeof i===u?i.apply(e):i),r+=a(i)+"</span>\n			",r}function v(e,t){var r="",i;return r+="\n				<span><b>Environment:</b> ",(i=n.environment)?i=i.call(e,{hash:{},data:t}):(i=e.environment,i=typeof i===u?i.apply(e):i),r+=a(i)+"</span>\n			",r}function m(e,t){return"\n	</div>\n</body>\n</html>\n"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;o=n["if"].call(t,t.includeWrapperMarkup,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n	<style>\n		\n		header {\n			display: block;\n			position: absolute;\n			top: 0;\n			left: 0;\n			right: 0;\n			height: 50px;\n			background: -moz-linear-gradient(top, rgba(0,0,0,0.87) 0%, rgba(79,79,79,1) 99%); /* FF3.6+ */\n			background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, rgba(0,0,0, 0.87)), color-stop(99%, rgba(79,79,79, 1))); /* Chrome, Safari4+ */\n			background: -webkit-linear-gradient(top, rgba(0,0,0, 0.87) 0%, rgba(79,79,79, 1) 99%); /* Chrome10+, Safari5.1+ */\n			background: -o-linear-gradient(top, rgba(0,0,0, 0.87) 0%, rgba(79,79,79, 1) 99%); /* Opera 11.10+ */\n			background: -ms-linear-gradient(top, rgba(0,0,0, 0.87) 0%, rgba(79,79,79, 1) 99%); /* IE10+ */\n			background: linear-gradient(to bottom, rgba(0,0,0, 0.87) 0%, rgba(79,79,79, 1) 99%); /* W3C */\n			filter: progid: DXImageTransform.Microsoft.gradient( startColorstr='#de000000', endColorstr='#4f4f4f', GradientType=0 ); /* IE6-9 */\n		}\n		\n		#header-logo {\n			text-indent: -9999px;\n			display: block;\n			position: absolute;\n			left: 0;\n			height: 51px;\n			width: 96px;\n			background-position: center center;\n			background-image: url(https://s.yimg.com/uy/build/images/flickr_logo_small_white.png);\n			background-image: -webkit-image-set(url(https://s.yimg.com/uy/build/images/flickr_logo_small_white.png) 1x, url(https://s.yimg.com/uy/build/images/flickr_logo_large_white.png) 2x);\n			background-repeat: no-repeat;\n		}\n		\n		#header-logout {\n			color: white;\n			position: absolute;\n			top: 0;\n			right: 0;\n			height: 50px;\n			padding: 15px;\n			text-align: right;\n			cursor: pointer;\n			cursor: hand;\n			display: block;\n		}\n		\n		#header-logout a {\n			color: white;\n		}\n		\n		body {\n			margin: 0; padding: 0; \n			font-family: \"Helvetica Neue\", helvetica, arial, sans-serif; \n			font-weight: 300;\n			color: #000;\n			overflow: hidden;\n			height: 100vh;\n			width: 100vw;\n		}\n\n		#bg {\n			transition: width 2s;\n			min-width: 600px;\n			min-height: 445px;\n			height: 100vh;\n			width: 100vw;\n			background-size: cover;\n			background-color: white;\n			background-image: url('https://s.yimg.com/uy/build/images/Panda_XL.jpg');\n			background-repeat: no-repeat;\n			background-position: center center;\n		}\n\n		.content {\n			position: absolute;\n			top: 20vh;\n			width: 3%;\n			right: 3vw; \n			z-index: 1;\n			padding: 10px;\n			width: 44%;\n			width: 44vw;\n			min-width: 525px;\n		}\n\n		.content span {\n			display: block;\n			line-height: 1.6em;\n			font-size: 17px;\n		}\n		\n		.content h1 + span {\n			margin-bottom: 1em;\n		}\n\n		h1 {\n			margin: 0;\n			font-weight: 300;\n			font-size: 44px;\n			margin-bottom: 24px;\n		}\n\n		a.attribution {\n			position: absolute;\n			bottom: 0;\n			right: 10px;\n			background-color: #000;\n			background: rgba(0,0,0, 0.45);\n			font-size: 11px;\n			padding: 7px 13px;\n			color: #dfdfdf;\n		}\n		\n		@media all and (max-width: 1600px) {\n			#bg {\n				background-image: url('https://s.yimg.com/uy/build/images/Panda_XL.jpg');\n			}\n		}\n		\n		@media all and (max-width: 941px) {\n			h1 {\n				font-size: 1.5em;\n				margin-bottom: 5vw;\n			}\n			\n			.content {\n				top: 40px;\n				right: 15vw; \n				margin: 20px auto 0 auto; \n				width: auto;\n				min-width: 20px;\n			}\n		}\n		\n		@media all and (max-width: 667px) {\n			\n			#bg {\n				background-position: right bottom;\n			}\n		}\n		\n		</style>\n",o=n["if"].call(t,t.includeWrapperMarkup,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+='\n	<header>\n		<span id="header-logo"></span>\n		<span id="header-logout"><a href="//',(o=n.host)?o=o.call(t,{hash:{},data:i}):(o=t.host,o=typeof o===u?o.apply(t):o),s+=a(o)+'/logout.gne">Sign out</a></span>\n	</header>\n	<div id="bg">\n		<a class="attribution" href="/photos/toyokazu/8644384737/">By Toyokazu</a>\n		<div class="content">	\n			<h1>Bad, bad panda!<br>\n			Come on. We want photos.</h1>\n			<span>We&rsquo;re aware of the problem and are fixing it. Thanks for your patience.</span>\n			',o=n["if"].call(t,t.message,{hash:{},inverse:f.noop,fn:f.program(5,h,i),data:i});if(o||o===0)s+=o;s+="\n			",o=n["if"].call(t,t.source,{hash:{},inverse:f.noop,fn:f.program(7,p,i),data:i});if(o||o===0)s+=o;s+="\n			",o=n["if"].call(t,t.requestID,{hash:{},inverse:f.noop,fn:f.program(9,d,i),data:i});if(o||o===0)s+=o;s+="\n			",o=n["if"].call(t,t.environment,{hash:{},inverse:f.noop,fn:f.program(11,v,i),data:i});if(o||o===0)s+=o;s+="\n		</div>\n	</div>\n",o=n["if"].call(t,t.includeWrapperMarkup,{hash:{},inverse:f.noop,fn:f.program(13,m,i),data:i});if(o||o===0)s+=o;return s}),r={};e.Array.each([],function(t){var n=e.Template
.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/error-500",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-keyboard-legend",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return'\n\n<div class="keyboard-shortcut-legend all-layout">\n	<ul class="keyboard-row">\n		<li class="key-size-0 key0">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">F</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Fave</span>\n		</li>\n		<li class="key-size-0 key1">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">C</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Comment</span>\n		</li>\n		<li class="key-size-0 key2">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">S</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Share</span>\n		</li>\n		<li class="key-size-0 key3">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">&lt;</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Prev</span>\n		</li>\n		<li class="key-size-0 key4">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">&gt;</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Next</span>\n		</li>\n		<li class="key-size-0 key5">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">esc</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Close</span>\n		</li>\n		<li class="key-size-0 key6">\n			<span class="key-container">\n				<a href="#" class="key-height half-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">?</span>\n						<span class="sub">/</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Shortcut dialog</span>\n		</li>\n	</ul>\n</div>\n<div class="show-legend">\n	<a href="#" class="show-legend-link">More</a>\n</div>\n\n'}function d(e,t){var r="",i;r+='\n\n<div class="keyboard-shortcut-legend ',(i=n.type)?i=i.call(e,{hash:{},data:t}):(i=e.type,i=typeof i===f?i.apply(e):i),r+=l(i)+'-layout">\n	<p class="keyboard-legend-title">Keyboard Shortcuts</p>\n	\n	',i=n.each.call(e,e.rows,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;return r+="\n\n	\n</div>\n\n",r}function v(e,t){var r="",i;r+='\n	<ul class="keyboard-row">\n		',i=n.each.call(e,e.keys,{hash:{},inverse:c.noop,fn:c.program(5,m,t),data:t});if(i||i===0)r+=i;return r+="\n	</ul>\n	",r}function m(e,t){var r="",i;r+='\n		<li class="key-size-',i=n["if"].call(e,e.keySize,{hash:{},inverse:c.program(8,y,t),fn:c.program(6,g,t),data:t});if(i||i===0)r+=i;r+=" ",(i=n.keyId)?i=i.call(e,{hash:{},data:t}):(i=e.keyId,i=typeof i===f?i.apply(e):i),r+=l(i)+'">\n			',i=n["if"].call(e,e.label,{hash:{},inverse:c.program(15,S,t),fn:c.program(10,b,t),data:t});if(i||i===0)r+=i;return r+="\n		</li>\n		",r}function g(e,t){var r;return(r=n.keySize)?r=r.call(e,{hash:{},data:t}):(r=e.keySize,r=typeof r===f?r.apply(e):r),l(r)}function y(e,t){return"0"}function b(e,t){var r="",i;r+='\n			<span class="key-container highlight">\n				<a href="#" class="key-height ',i=n["if"].call(e,e.label2,{hash:{},inverse:c.noop,fn:c.program(11,w,t),data:t});if(i||i===0)r+=i;r+='" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span>\n						",i=n["if"].call(e,e.label2,{hash:{},inverse:c.noop,fn:c.program(13,E,t),data:t});if(i||i===0)r+=i;return r+="\n					</span>\n				</a>\n			</span>\n			",r}function w(e,t){return"half-height"}function E(e,t){var r="",i;return r+='\n						<span class="sub">',(i=n.label2)?i=i.call(e,{hash:{},data:t}):(i=e.label2,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span>\n						",r}function S(e,t){return'\n			<span class="key-container"></span>\n			'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;a={hash:{},inverse:c.program(3,d,i),fn:c.program(1,p,i),data:i},u=(o=n.ifCond||t.ifCond,o?o.call(t,t.type,"===","short",a):h.call(t,"ifCond",t.type,"===","short",a));if(u||u===0)s+=u;return s+="\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/keyboard-legend",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-html5-balls",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'\n<div class="html5-balls">\n	<div class="blueball"></div>\n	<div class="pinkball"></div>\n</div>\n'}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/html5-balls",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-html4-balls",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'\n<div class="html4-balls"></div>\n'}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/html4-balls",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("html5-balls",function(e){var t=!(e.UA.ie&&e.UA.ie<9),n;n=function(e){return t?"html5-balls":"html4-balls"},e.augment(n,e.Attribute),e.Balls=n},"@VERSION@",{requires:["base","html5-balls-css","hermes-template-html5-balls","hermes-template-html4-balls","handlebars-helpers","template-base"]});
YUI.add("keyboard-legend-view",function(e){var t={qwerty:[{keys:[{keyId:"key0",label:"esc"}]},{keys:[{keyId:"key1"},{keyId:"key2"},{keyId:"key3"},{keyId:"key4"},{keyId:"key5"},{keyId:"key6"},{keyId:"key7"},{keyId:"key8"},{keyId:"key9"},{keyId:"key10"},{keyId:"key11"},{keyId:"key12"},{keyId:"key13"},{keyId:"key14",keySize:1}]},{keys:[{keyId:"key15",keySize:1},{keyId:"key16"},{keyId:"key17"},{keyId:"key18",label:"E"},{keyId:"key19"},{keyId:"key20",label:"T"},{keyId:"key21"},{keyId:"key22"},{keyId:"key23"},{keyId:"key24"},{keyId:"key25",label:"P"},{keyId:"key26"},{keyId:"key27"},{keyId:"key28"}]},{keys:[{keyId:"key29",keySize:4},{keyId:"key30",label:"A"},{keyId:"key31",label:"S"},{keyId:"key32"},{keyId:"key33",label:"F"},{keyId:"key34",label:"G"},{keyId:"key35"},{keyId:"key36",label:"J"},{keyId:"key37",label:"K"},{keyId:"key38",label:"L"},{keyId:"key39"},{keyId:"key40"},{keyId:"key41",keySize:4}]},{keys:[{keyId:"key42",keySize:5},{keyId:"key43"},{keyId:"key44"},{keyId:"key45",label:"C"},{keyId:"key46"},{keyId:"key47"},{keyId:"key48"},{keyId:"key49"},{keyId:"key50",label:"<",label2:","},{keyId:"key51",label:">",label2:"."},{keyId:"key52",label:"?",label2:"/"},{keyId:"key53",keySize:5}]},{keys:[{keyId:"key54"},{keyId:"key55"},{keyId:"key56"},{keyId:"key57",keySize:6},{keyId:"key58",keySize:7},{keyId:"key59",keySize:6},{keyId:"key60"},{keyId:"key61",keySize:8,label:"<"},{keyId:"key62 row5-key-fix",keySize:9},{keyId:"key63",keySize:8},{keyId:"key64",keySize:8,label:">"}]}],nonqwerty:[{keys:[{keyId:"key0",label:"esc",keySize:10}]},{keys:[{keyId:"key1"},{keyId:"key2"},{keyId:"key3"},{keyId:"key4"},{keyId:"key5"},{keyId:"key6"},{keyId:"key7"},{keyId:"key8"},{keyId:"key9"},{keyId:"key10"},{keyId:"key11"},{keyId:"key12"},{keyId:"key13"},{keyId:"key14",keySize:1}]},{keys:[{keyId:"key15",keySize:1},{keyId:"key16"},{keyId:"key17"},{keyId:"key18",label:"E"},{keyId:"key19"},{keyId:"key20",label:"T"},{keyId:"key21"},{keyId:"key22"},{keyId:"key23"},{keyId:"key24"},{keyId:"key25",label:"P"},{keyId:"key26",label:"{",label2:"["},{keyId:"key27",label:"}",label2:"]"},{keyId:"key28 row2-key-fix-bottom"},{keyId:"row2-key-fix"}]},{keys:[{keyId:"key29",keySize:4},{keyId:"key30",label:"A"},{keyId:"key31",label:"S"},{keyId:"key32"},{keyId:"key33",label:"F"},{keyId:"key34",label:"G"},{keyId:"key35"},{keyId:"key36",label:"J"},{keyId:"key37",label:"K"},{keyId:"key38",label:"L"},{keyId:"key39"},{keyId:"key40"},{keyId:"key41"},{keyId:"key42 row3-key-fix-top",keySize:2},{keyId:"row3-key-fix"}]},{keys:[{keyId:"key43",keySize:3},{keyId:"key44"},{keyId:"key45"},{keyId:"key46"},{keyId:"key47",label:"C"},{keyId:"key48"},{keyId:"key49"},{keyId:"key50"},{keyId:"key51"},{keyId:"key52",label:"<",label2:","},{keyId:"key53",label:">",label2:"."},{keyId:"key54",label:"?",label2:"/"},{keyId:"key55",keySize:5}]},{keys:[{keyId:"key56"},{keyId:"key57"},{keyId:"key58"},{keyId:"key59",keySize:6},{keyId:"key60",keySize:7},{keyId:"key61",keySize:6},{keyId:"key62"},{keyId:"key63",keySize:8,label:"<"},{keyId:"key64 row5-key-fix",keySize:9},{keyId:"key65",keySize:8},{keyId:"key66",keySize:8,label:">"}]}]};e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(n){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(e.Balls()),this.layouts=t,this.advanced=!1,this.type="nonqwerty",this},buildContainer:function(){var e=this.templates("keyboard-legend")({type:this.advanced?this.type:"short",rows:this.layouts[this.type]});return this.setContainerHTML(e),this},dialogKeyPressed:function(){e.fire("flickr:photo-page:hideKeyboardLegend")},showAdvanced:function(){this.advanced=!0,this.buildContainer()},activate:function(){var e=this.get("container").one(".show-legend-link"),t=this;return this.attachKeyEvent("down:191",this.dialogKeyPressed.bind(this)),e&&this.registerEventHandler(e.on("click",function(e){e.preventDefault(),t.showAdvanced()})),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-keyboard-legend","keyboard-legend-css","html5-balls"]});
YUI.add("hermes-template-fluid-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return" html-modal"}function h(e,t){return" subview-modal"}function p(e,t){return'<div class="close-x"></div>'}function d(e,t){var r="",i;r+='\n		<div class="head">\n			',i=n["if"].call(e,e.navBarView,{hash:{},inverse:l.program(10,m,t),fn:l.program(8,v,t),data:t});if(i||i===0)r+=i;return r+='\n			<div class="extra"></div>\n		</div>\n	',r}function v(e,t){return'\n				<div class="nav"></div>\n			'}function m(e,t){var r="",i;r+='\n				<div class="title">\n					',i=n["if"].call(e,e.title,{hash:{},inverse:l.program(13,y,t),fn:l.program(11,g,t),data:t});if(i||i===0)r+=i;return r+="\n				</div>\n			",r}function g(e,t){var r="",i;return r+="\n						",(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n					",r}function y(e,t){var r="",i,s;return r+="\n						",s={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.htmlTitle,s):f.call(e,"renderTrustedMarkup",e.htmlTitle,s)))+"\n					",r}function b(e,t){return" lines"}function w(e,t){var r="",i;r+='\n			<div class="content text-only ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;return r+='">\n				',(i=n.textMessage)?i=i.call(e,{hash:{},data:t}):(i=e.textMessage,i=typeof i===u?i.apply(e):i),r+=a(i)+"\n			</div>\n		",r}function E(e,t){return" no-scroll"}function S(e,t){var r="",i,s;r+='\n			<div class="content html-only ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;return r+='">\n				',s={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.htmlMessage,s):f.call(e,"renderTrustedMarkup",e.htmlMessage,s)))+"\n			</div>\n		",r}function x(e,t){var r="",i;r+='\n			<div class="content subview ',i=n["if"].call(e,e.noScroll,{hash:{},inverse:l.noop,fn:l.program(18,E,t),data:t});if(i||i===0)r+=i;return r+='"></div>\n		',r}function T(e,t){var r="",i,s;r+='\n		<div class="foot">\n			',s=n["if"].call(e,(i=e.buttons,i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(25,N,t),data:t});if(s||s===0)r+=s;return r+="\n		</div>\n	",r}function N(e,t){var r="",i,s;r+='\n			<div class="buttons">\n				',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(26,C,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.cancel),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(31,A,t),data:t});if(s||s===0)r+=s;r+="\n				",s=n["if"].call(e,(i=e.buttons,i==null||i===!1?i:i.flavorText),{hash:{},inverse:l.noop,fn:l.program(33,O,t),data:t});if(s||s===0)r+=s;return r+="\n			</div>\n			",r}function C(e,t){var r="",i,s;r+='<button class="medium ',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.isDangerous),{hash:{},inverse:l.noop,fn:l.program(27,k,t),data:t});if(s||s===0)r+=s;r+=' action"',s=n["if"].call(e,(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.disabled),{hash:{},inverse:l.noop,fn:l.program(29,L,t),data:t});if(s||s===0)r+=s;return r+=">"+a((i=(i=(i=e.buttons,i==null||i===!1?i:i.action),i==null||i===!1?i:i.label),typeof i===u?i.apply(e):i))+"</button>",r}function k(e,t){return"danger"}function L(e,t){return' disabled="disabled"'}function A(e,t){var n="",r;return n+='<button class="medium alt cancel">'+a((r=(r=(r=e.buttons,r==null||r===!1?r:r.cancel),r==null||r===!1?r:r.label),typeof r===u?r.apply(e):r))+"</button>",n}function O(e,t){var r="",i,s,o;r+='\n				<div class="flavor-text secondary',s=n.unless.call(e,(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.visible),{hash:{},inverse:l.noop,fn:l.program(34,M,t),data:t});if(s||s===0)r+=s;return r+='">',o={hash:{},data:t},r+=a((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.text),o):f.call(e,"renderTrustedMarkup",(i=(i=e.buttons,i==null||i===!1?i:i.flavorText),i==null||i===!1?i:i.text),o)))+"</div>\n				",r}function M(e,t){return" hidden"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=n.helperMissing,l=this;s+='<div class="modal',o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;s+=" ",(o=n.classList)?o=o.call(t,{hash:{},data:i}):(o=t.classList,o=typeof o===u?o.apply(t):o),s+=a(o)+'">\n	',o=n["if"].call(t,t.showCancelX,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;s+="\n	",o=n["if"].call(t,t.showHeader,{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(o||o===0)s+=o;s+='\n	<div class="body',o=n["if"].call(t,t.showBodyLines,{hash:{},inverse:l.noop,fn:l.program(15,b,i),data:i});if(o||o===0)s+=o;s+='">\n		',o=n["if"].call(t,t.textMessage,{hash:{},inverse:l.noop,fn:l.program(17,w,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.htmlMessage,{hash:{},inverse:l.noop,fn:l.program(20,S,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.subview,{hash:{},inverse:l.noop,fn:l.program(22,x,i),data:i});if(o||o===0)s+=o;s+="\n	</div>\n	",o=n["if"].call(t,t.showFooter,{hash:{},inverse:l.noop,fn:l.program(24,T,i),data:i});if(o||o===0)s+=o;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-modal-view",function(e){"use strict";var t,n;t={css:{destinationContainer:"body",closeX:".close-x",buttonCancel:"button.cancel",buttonAction:"button.action",navBarContent:".head .nav",subviewContent:".content.subview",modalContent:".body .content"},options:{}},n={supportsTransform:!1,modal:{height:0,width:0}},e.namespace("Views").FluidModal=e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(t){return this.set("isActiveViewAgnostic",!0),this.alreadyShowingModal=e.OverlayManager.ModalOverlay.alreadyShowingModal(),this.alreadyShowingModal||e.OverlayManager.ModalOverlay.add(this),this},activate:function(){var n=this.get("container"),r=this;return this.get("showCancelX")&&this.registerEventHandler(n.one(t.css.closeX).on("click",e.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showCancelButton")&&this.get("showButtons")&&this.registerEventHandler(n.one(t.css.buttonCancel).on("click",e.bind(this.handleCancel,this))),this.get("showFooter")&&this.get("showActionButton")&&this.get("showButtons")&&this.registerEventHandler(n.one(t.css.buttonAction).on("click",e.bind(this.handleAction,this))),this.registerEventHandler(e.on("history:change",function(e){if(e.src==="popstate"&&e.prevVal&&e.newVal)if(e.prevVal.flickr&&e.prevVal.flickr.referrer||e.newVal.flickr&&e.newVal.flickr.referrer)return;r.close(e)})),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){r.reposition()})),this.get("navBarView")&&r.get("navBarView").activate(),this.get("subview")&&(r.get("subview").activate(),r.registerEventHandler(r.get("subview").on("actionClick",e.bind(r.handleAction,r)))),this.fire("activated"),this},show:function(){return this.initialize().then(null,function(t){e.Flog.error("[fluid-modal-view] Error initializing modal: ",t)}),this.isClosed=!1,this.freeze(),e.fire("flickr:setKeyEventScope",this.getKeyEventScope()),this},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})},enableActionButton:function(){var e=this.get("container").one("button.action");e&&e.getAttribute("disabled")&&e.removeAttribute("disabled")},disableActionButton:function(){var e=this.get("container").one("button.action");e&&e.setAttribute("disabled",!0)},showFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.removeClass("hidden")},hideFlavorText:function(){var e=this.get("container").one(".buttons .flavor-text");e&&e.addClass("hidden")},buildContainer:function(){if(!this.alreadyShowingModal){var r=this,i=e.one(t.css.destinationContainer),s;s={showCancelX:this.get("showCancelX"),title:this.get("title"),htmlTitle:this.get("htmlTitle"),navBarView:!!this.get("navBarView"),noScroll:this.get("noScroll"),textMessage:this.get("textMessage"),htmlMessage:this.get("message")?this.get("message"):this.get("htmlMessage"),subview:!!this.get("subview"),showBodyLines:this.get("showBodyLines"),hideModalOverlay:this.get("hideModalOverlay"),darkOverlay:this.get("darkOverlay"),showHeader:this.get("showHeader"),showFooter:this.get("showFooter"),buttons:{visible:this.get("showButtons"),action:{visible:this.get("showActionButton"),label:this.get("actionButtonLabel"),disabled:this.get("actionButtonDisabled"),isDangerous:this.get("actionButtonIsDangerous")},cancel:{visible:this.get("showCancelButton"),label:this.get("cancelButtonLabel")}},classList:this.get("classList")},this.get("buttonFlavorText")&&(s.buttons.flavorText={visible:this.get("showButtonFlavorText"),text:this.get("buttonFlavorText")}),this.setContainerHTML(this.templates("fluid-modal")(s)),n.modal.width=this.get("width"),n.modal.minWidth=this.get("minWidth"),n.modal.height=this.get("height"),this.get("navBarView")&&(this.get("navBarView").appContext=r.appContext,this.get("navBarView").initialize().then(function(e){e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(r.get("subview")&&e.details[0]==="navigation"?r.get("subview").fire.apply(r.get("subview"),["parentViewEvent"].concat(e.details)):r.get("subview")&&e.details[0]==="search"&&r.get("subview").fire.apply(r.get("subview"),["parentViewEvent"].concat(e.details)),r.fire.apply(r,e.details))}),r.get("container").one(t.css.navBarContent).appendChild(e.get("container")),r.get("subview")||r.activate()})),this.get("subview")?(this.get("subview").appContext=r.appContext,this.get("subview").set("isActiveViewAgnostic",!0),this.get("subview").initialize().then(function(e){r.on("parentViewEvent",function(t){t&&t.details&&t.details.length&&e.fire.apply(e,["parentViewEvent"].concat(t.details))}),e.on("subviewViewEvent",function(e){e&&e.details&&e.details.length&&(r.get("navBarView")&&e.details[0]==="backToList"&&r.get("navBarView").fire.apply(r.get("navBarView"),["parentViewEvent"].concat(e.details)),r.fire.apply(r,e.details))}),r.get("container").one(t.css.subviewContent).appendChild(e.get("container")),i&&(i.append(r.get("container")),r.reposition()),r.activate()},function(t){e.Flog.error("[fluid-modal-view] Error initializing modal subview: ",t)})):i&&(i.append(this.get("container")),this.reposition())}return this},reposition:function(){var r=this.get("container"),i=r.one(".modal"),s=e.one(e.config.win),o=parseInt(s.get("innerWidth"),10),u=parseInt(s.get("innerHeight"),10),a=n.modal.width?parseInt(n.modal.width,10):parseInt(i.getComputedStyle("width"),10),f,l,c=20,h,p={},d,v,m=i.one(".body"),g,y,b,w=parseInt(m.getComputedStyle("borderTopWidth"),10)+parseInt(m.getComputedStyle("borderBottomWidth"),10),E={};n.modal.height&&(g=parseInt(i.one(".head").getComputedStyle("height"),10),b=n.modal.height,y=parseInt(i.one(".foot").getComputedStyle("height"),10),n.modal.height+g+y+4*c+w>=u&&(b=u-g-y-4*c-w),i.setStyles({maxHeight:"none"}),this.get("fullWindow")?E.height=b+"px":this.get("maxHeight")&&(E.maxHeight=b+"px"),i.one(t.css.modalContent).setStyles(E)),f=this._getMiddleXPositionOfScreen(o,a),l=parseInt(i.getComputedStyle("height"),10),d=i.getDOMNode().scrollHeight,v=i.getDOMNode
().scrollWidth,h=this._getMiddleYPositionOfScreen(u,l),p={top:h+"px",left:f+"px",width:n.modal.width?a+"px":"",minWidth:n.modal.minWidth?n.modal.minWidth+"px":""},l+2*c>u||d>l+1||a+2*c>o||v>a?(p.top=e.DOM.docScrollY()+5+"px",p.maxHeight=u-2*c+"px",p.maxWidth=o-2*c+"px",p.overflow="auto"):(p.maxHeight="inherit",p.maxWidth="inherit",p.overflow="visible"),i.setStyles(p)},_getMiddleXPositionOfScreen:function(t,n){return Math.round(t/2)-Math.round(n/2)+e.DOM.docScrollX()},_getMiddleYPositionOfScreen:function(t,n){return Math.round(t/2)-Math.round(n/2)+e.DOM.docScrollY()},handleCancel:function(e){this.fire("cancelClick",e),this.close(e)},handleAction:function(e){this.fire("actionClick",e),this.get("dismissOnActionClick")&&this.close(e)},close:function(t){e.fire("flickr:removeKeyEventScope",this.getKeyEventScope());var n=this.get("container");this.isClosed=!0,e.one("body").removeClass("scroll-fluid-modal"),this.get("subview")&&this.get("subview").destroy(),this.get("navBarView")&&this.get("navBarView").destroy(),n&&n.remove(!0),this.fire("close",t),this.destroy(),e.OverlayManager.ModalOverlay.remove(this)},getKeyEventScope:function(){return this.name+this._yuid},destructor:function(){this.unfreeze(),this.detachAll()}},{ATTRS:{showCancelX:{value:!0},showCancelButton:{value:!0},showBodyLines:{value:!1},showActionButton:{value:!0},hideModalOverlay:{value:!1},darkOverlay:{value:!1},actionButtonLabel:{value:"OK"},actionButtonIsDangerous:{value:!1},cancelButtonLabel:{value:"Cancel"},actionButtonDisabled:{value:!1},showButtons:{value:!0},dismissOnOverlayClick:{value:!1},dismissOnActionClick:{value:!0},title:{value:null},htmlTitle:{value:null},navBarView:{value:null},message:{value:null},textMessage:{value:null},htmlMessage:{value:null},width:{value:0},minWidth:{value:0},height:{value:0},fullWindow:{value:!1},subview:{value:null},classList:{value:""},buttonFlavorText:{value:""},showButtonFlavorText:{value:!0},showHeader:{value:!0},showFooter:{value:!0},noScroll:{value:!1},maxHeight:{value:!0}}})},"@VERSION@",{requires:["flickr-view","fluid-css","hermes-template-fluid-modal","fluid-overlay-manager-view","flog"],optionalRequires:["fluid"]});
YUI.add("curation-photomappings-model",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-licensing-curation-photomappings"].run(t,this.appContext)}},attributes:{status:{},ownerStatus:{},category:{},collection:{},useType:{},technical:{},legal:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-licensing-curation-photomappings-fetcher"]});
YUI.add("flickr-licensing-curation-photomappings-fetcher",function(e,t){"use strict";function n(e){var t={};return t}function r(e,t){var n,r,i,s,o,u,a,f,l,c=e[0];r=c.status?c.status.item:null,i=c.ownerStatus?c.ownerStatus:null,s=c.category?c.category.item:null,o=c.collection?c.collection.item:null,a=c.technical?c.technical.item:null,f=c.legal?c.legal.item:null,u=c.useType?c.useType.item:null,n={id:t.id,status:r,ownerStatus:i,category:s,collection:o,useType:u,technical:a,legal:f},l=e[1],l.exists(t.id)||l.add(n)}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.licensing.curation.getPhotoMappings",this._processParams(n)),r.getModelRegistry("curation-photomappings-model")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-licensing-curation-photomappings"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["curation-photomappings-model"]});
YUI.add("hermes-template-curator-tool-photo-metadata-form",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing;return s+='<div id="curator-photo-',(o=n.photoId)?o=o.call(t,{hash:{},data:i}):(o=t.photoId,o=typeof o===f?o.apply(t):o),s+=l(o)+'">\n	<div class="photo-preview">\n		<img src="',(o=n.imgUrl)?o=o.call(t,{hash:{},data:i}):(o=t.imgUrl,o=typeof o===f?o.apply(t):o),s+=l(o)+'" alt="" />\n	</div>\n	<div class="photo-metadata">\n		\n		<div class="category-collection">\n			<div class="category">\n				<label for="photo-category-',(o=n.photoId)?o=o.call(t,{hash:{},data:i}):(o=t.photoId,o=typeof o===f?o.apply(t):o),s+=l(o)+'">Category *</label>\n				<div class="field-wrapper">\n					<div class="selectbox">\n						<div class="select-fade"></div>\n						<div class="select-arrow"></div>\n						<select class="photo-category-select" id="photo-category-',(o=n.photoId)?o=o.call(t,{hash:{},data:i}):(o=t.photoId,o=typeof o===f?o.apply(t):o),s+=l(o)+'" name="photo-category-',(o=n.photoId)?o=o.call(t,{hash:{},data:i}):(o=t.photoId,o=typeof o===f?o.apply(t):o),s+=l(o)+"\" required><option value='0'>None</option>",a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.categoryOptions,a):c.call(t,"renderTrustedMarkup",t.categoryOptions,a)))+'</select>\n					</div>\n				</div>\n			</div>\n			<div class="collection">\n				<label for="photo-collection-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">Collection</label>\n				<div class="field-wrapper">\n					<div class="selectbox">\n						<div class="select-fade"></div>\n						<div class="select-arrow"></div>\n						<select class="photo-collection-select" id="photo-collection-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'" name="photo-collection-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.collectionOptions,a):c.call(t,"renderTrustedMarkup",t.collectionOptions,a)))+'</select>\n					</div>\n				</div>\n			</div>\n		</div>\n		\n		<div class="use-type-releases">\n			\n			<div class="use-type">\n				<label for="photo-use-type-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">Use Type *</label>\n				<div class="field-wrapper">\n					<div class="selectbox">\n						<div class="select-fade"></div>\n						<div class="select-arrow"></div>\n						<select class="photo-use-type-select" id="photo-use-type-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'" name="photo-use-type-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+"\" required><option value='0'>None</option>",a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.useTypeOptions,a):c.call(t,"renderTrustedMarkup",t.useTypeOptions,a)))+'</select>\n					</div>\n				</div>\n			</div>\n			<div class="model-releases">\n				<label for="photo-model-releases-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">Model Releases</label>\n				<div class="field-wrapper">\n					<div class="selectbox">\n						<div class="select-fade"></div>\n						<div class="select-arrow"></div>\n						<select class="photo-model-releases-select" id="photo-model-releases-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'" name="photo-model-releases-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.modelReleasesOptions,a):c.call(t,"renderTrustedMarkup",t.modelReleasesOptions,a)))+'</select>\n					</div>\n				</div>\n			</div>\n			<div class="property-releases">\n				<label for="photo-property-releases-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">Property Releases</label>\n				<div class="field-wrapper">\n					<div class="selectbox">\n						<div class="select-fade"></div>\n						<div class="select-arrow"></div>\n						<select class="photo-property-releases-select" id="photo-property-releases-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'" name="photo-property-releases-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.propertyReleasesOptions,a):c.call(t,"renderTrustedMarkup",t.propertyReleasesOptions,a)))+'</select>\n					</div>\n				</div>\n			</div>\n		</div>\n		\n		<div class="technical">\n			<label for="photo-technical-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">Technical</label>\n			<div class="field-wrapper">\n				<div class="selectbox">\n					<div class="select-fade"></div>\n					<div class="select-arrow"></div>\n					<select class="photo-technical-select" id="photo-technical-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'" name="photo-technical-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">',a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.technicalOptions,a):c.call(t,"renderTrustedMarkup",t.technicalOptions,a)))+'</select>\n				</div>\n			</div>\n		</div>\n		\n		<div class="legal">\n			<label for="photo-legal-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'">Legal</label>\n			<div class="field-wrapper">\n				<div class="selectbox">\n					<div class="select-fade"></div>\n					<div class="select-arrow"></div>\n					<select class="photo-legal-select" id="photo-legal-'
,(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+'" name="photo-legal-',(u=n.photoId)?u=u.call(t,{hash:{},data:i}):(u=t.photoId,u=typeof u===f?u.apply(t):u),s+=l(u)+"\"><option value='0'>None</option>",a={hash:{},data:i},s+=l((o=n.renderTrustedMarkup||t.renderTrustedMarkup,o?o.call(t,t.legalOptions,a):c.call(t,"renderTrustedMarkup",t.legalOptions,a)))+"</select>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/curator-tool-photo-metadata-form",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("curator-photo-tools-view",function(e){e.namespace("Views")[this.name]=e.Base.create("curator-photo-tools-view",e.FlickrView,[],{initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.isModalOpen=!1,this.modal=null,this.photoStatusId=null,this.photoStatusMap=null,this},subviewConfig:{},loadState:function(){var t=this,n;return n={curationPhotomappingsModel:this.appContext.getModel("curation-photomappings-model",this.nsid),photoModel:this.appContext.getModel("photo-models",this.photoId),photoStatus:this.getPhotoStatus()},(new e.FlickrPromise(n)).then(function(e){t.curationPhotomappingsModel=e.curationPhotomappingsModel,t.photoStatusMap=t.curationPhotomappingsModel.getValue("status"),t.photographerStatusMap=t.curationPhotomappingsModel.getValue("owner_status"),t.photoModel=e.photoModel,t.photoStatusId=e.photoStatusId,t.photoStatusId=parseInt(e.photoStatus.status,10),t.is3Megapixels=e.photoStatus.is_3Megapixels?e.photoStatus.is_3Megapixels:0,t.ownerAddedForCuration=e.photoStatus.ownerAddedForCuration?e.photoStatus.ownerAddedForCuration:0,t.ownerEnrolled=e.photoStatus.ownerEnrolled?e.photoStatus.ownerEnrolled:0,t.ownerLocked=e.photoStatus.ownerLocked?e.photoStatus.ownerLocked:0,t.ownerClaimedByMe=e.photoStatus.ownerClaimedByMe?e.photoStatus.ownerClaimedByMe:0,t.photoAddedForCuration=e.photoStatus.photoAddedForCuration?e.photoStatus.photoAddedForCuration:0,t.ownerId=e.photoStatus.ownerId?e.photoStatus.ownerId:0,t.ownerStatusId=e.photoStatus.ownerStatus?e.photoStatus.ownerStatus:"None",t.photographerClaimedBy=e.photoStatus.ownerClaimedByByid?e.photoStatus.ownerClaimedByByid:"Who Knows?!",t.photographerStatus=e.photoStatus.ownerStatus?e.photoStatus.ownerStatus:"None"},function(e){console.log("Error getting photomapping model or photo model",e)})},getPhotoStatus:function(){return this.appContext.callAPI("flickr.licensing.curation.getPhotoStatus",{photo_id:this.photoId}).then(function(e){return e.photos.photo.curation[0]},function(){console.error("Error calling API method: flickr.licensing.curation.getPhotoStatus",arguments)})},buildContainer:function(){return this},activate:function(){var e,t=this;return e=this.appContext.getViewer().prefs.keyboardShortcutsEnabled,this.setupCuratorTools(),e&&this.registerEventHandler(this.attachKeyEvent("down:87",function(e){e.preventDefault(),t.handleAddPhotoClick(e)})),this},destructor:function(){e.one("#curator-control-panel")&&e.one("#curator-control-panel").remove(!0)},setupCuratorTools:function(){if(this.get("destroyed"))return;var t,n=this;this.ownerEnrolled?(this.ownerLocked?e.one("#content").appendChild(e.Node.create('<div id="curator-control-panel"><p>LOCKED</p></div>')):!this.photoAddedForCuration&&this.ownerClaimedByMe?e.one("#content").appendChild(e.Node.create('<div id="curator-control-panel"><button id="curator-photo-submit">Add this photo</button></div>')):this.ownerClaimedByMe&&this.photoAddedForCuration?e.one("#content").appendChild(e.Node.create('<div id="curator-control-panel"><p><a href="/god/licensing/curation/editor_2/accounts/'+this.ownerId+"/photos/\">Update this photographer's photos</a></p></div>")):e.one("#content").appendChild(e.Node.create('<div id="curator-control-panel"><p><a href="/god/licensing/curation/editor_2/accounts/'+this.ownerId+'/">Update this photographer</a></div></p>')),e.Array.find(this.photoStatusMap,function(e){if(e.id===n.photoStatusId)return t=e.name,!0}),e.one("#curator-control-panel")&&(this.photoAddedForCuration?e.one("#curator-control-panel").appendChild(e.Node.create('<div id="curator-photo-status"><p>Photo status: <strong>'+t+"</strong></p></div>")):e.one("#curator-control-panel").appendChild(e.Node.create('<div id="curator-photo-status"><p>Photo status: <strong>none</strong></p></div>')),this.ownerClaimedByMe?e.one("#curator-control-panel").appendChild(e.Node.create('<div id="photographer-claimed-by"><p>Claimed by: YOU!</p>')):e.one("#curator-control-panel").appendChild(e.Node.create('<div id="photographer-claimed-by"><p>Claimed by: '+this.photographerClaimedBy+"</p>")))):this.ownerAddedForCuration?e.one("#content").appendChild(e.Node.create('<div id="curator-control-panel"><p>Photographer status: <strong>'+this.photographerStatus+'</strong></p><p><a href="/god/licensing/curation/editor_1/accounts/'+this.ownerId+'/">Update this photographer</a></p></div>')):e.one("#content").appendChild(e.Node.create('<div id="curator-control-panel"><p>Photographer status: <strong>none</strong></p><p><a href="/god/licensing/curation/editor_1/accounts/'+this.ownerId+'/">Add this photographer</a></p></div>')),this.is3Megapixels&&e.one("#curator-control-panel")&&e.one("#curator-control-panel").appendChild(e.Node.create('<img src="https://s.yimg.com/g/images/3mp.gif" alt=""/>')),this.registerEventHandler(e.one("#curator-photo-submit").on("click",this.handleAddPhotoClick,this))},updateStatus:function(){var t=this;this.appContext.callAPI("flickr.licensing.curation.getPhotoStatus",{photo_id:this.photoId}).then(function(n){var r=n.photos.photo.curation[0];t.photoStatusId=parseInt(r.status,10),t.is3Megapixels=r.is_3Megapixels?r.is_3Megapixels:0,t.ownerAddedForCuration=r.ownerAddedForCuration?r.ownerAddedForCuration:0,t.ownerEnrolled=r.ownerEnrolled?r.ownerEnrolled:0,t.ownerLocked=r.ownerLocked?r.ownerLocked:0,t.ownerClaimedByMe=r.ownerClaimedByMe?r.ownerClaimedByMe:0,t.photoAddedForCuration=r.photoAddedForCuration?r.photoAddedForCuration:0,t.ownerId=r.ownerId?r.ownerId:0,t.ownerStatusId=r.ownerStatus?r.ownerStatus:"None",t.photographerClaimedBy=r.ownerClaimedByByid?r.ownerClaimedByByid:"Who Knows?!",t.photographerStatus=r.ownerStatus?r.ownerStatus:"None",e.one("#curator-control-panel")&&e.one("#curator-control-panel").remove(!0),t.setupCuratorTools()})},handleAddPhotoClick:function(t){t.preventDefault();var n="",r=this;if(this.isModalOpen&&this.modal){this.modal.close(),this.isModalOpen=!1,this.modal=null;return}n='<form id="curator-photo-selection-form">',n+=this.buildPhotoCurationForm(this.photoId,this.
getImageUrl(this.photoModel)),n+="</form>",this.modal=(new e.Views.FluidModal({appContext:r.appContext,title:"Submit this photo",htmlMessage:n,width:840,height:600,dismissOnActionClick:!1})).show(),this.registerEventHandler(this.modal.on("activated",function(t){this.isModalOpen=!0,e.one("#curator-photo-selection-form .photo-category-select").focus()},this)),this.registerEventHandler(this.modal.on("actionClick",this.handlePhotoSubmission,this)),this.registerEventHandler(this.modal.on("cancelClick",function(e){this.isModalOpen=!1,this.modal=null},this))},buildPhotoCurationForm:function(e,t){var n;return this.photoFormState=this.getPhotoMetadata("curator-photo-form-state"),n=this.templates("curator-tool-photo-metadata-form")({categoryOptions:this.buildOptions("category"),collectionOptions:this.buildOptions("collection"),modelReleasesOptions:this.buildOptions("model-releases"),propertyReleasesOptions:this.buildOptions("property-releases"),technicalOptions:this.buildOptions("technical"),legalOptions:this.buildOptions("legal"),useTypeOptions:this.buildOptions("useType"),photoId:e,imgUrl:t}),n},buildOptions:function(t){var n="",r,i,s,o=this;if(this.photoFormState)try{s=e.JSON.parse(this.photoFormState)}catch(u){console.error("Error parsing JSON from local storage",u)}if(t==="model-releases"||t==="property-releases")for(r=0;r<=20;r++)n+='<option value="'+r+'">'+r+"</option>";else i=this.curationPhotomappingsModel.getValue(t),t==="technical"&&i.unshift({id:0,name:"None"}),t==="collection"&&o.photoModel.getValue("license")!==0&&e.Array.find(i,function(e,t){return e.name==="Flickr Prime (RM)"?(i.splice(t,1),!0):!1}),e.Array.each(i,function(e){if(t==="technical")if(o.is3Megapixels)switch(parseInt(e.id,10)){case 4:case 5:case 6:case 7:case 9:return}else switch(parseInt(e.id,10)){case 0:case 1:case 2:case 3:case 9:return}t==="category"||t==="collection"?s&&s[t]&&parseInt(s[t],10)===e.id?n+='<option value="'+e.id+'" selected>'+e.name+"</option>":n+='<option value="'+e.id+'">'+e.name+"</option>":n+='<option value="'+e.id+'">'+e.name+"</option>"});return n},getImageUrl:function(e){var t=e.getValue("ascendingSizes"),n=Math.min(5,t.length-1);return t[n].url},handlePhotoSubmission:function(t){var n,r,i=this.photoId,s,o=this;n={photos:{photo:[]}},r=e.one("#curator-photo-selection-form");if(!r)return;r.one(".photo-use-type-select").removeClass("error"),r.one(".photo-category-select").removeClass("error"),(r.one(".photo-category-select").get("value")===""||r.one(".photo-category-select").get("value")==="0")&&r.one(".photo-category-select").addClass("error"),(r.one(".photo-use-type-select").get("value")===""||r.one(".photo-use-type-select").get("value")==="0")&&r.one(".photo-use-type-select").addClass("error");if(r.one(".photo-category-select").get("value")===""||r.one(".photo-category-select").get("value")==="0"||r.one(".photo-use-type-select").get("value")===""||r.one(".photo-use-type-select").get("value")==="0")return!1;n.photos.photo.push({id:i,category:r.one(".photo-category-select").get("value"),collection:r.one(".photo-collection-select").get("value"),model_releases:r.one(".photo-model-releases-select").get("value"),property_releases:r.one(".photo-property-releases-select").get("value"),technical_review:r.one(".photo-technical-select").get("value"),legal_review:r.one(".photo-legal-select").get("value"),use_type:r.one(".photo-use-type-select").get("value")}),s={category:r.one(".photo-category-select").get("value"),collection:r.one(".photo-collection-select").get("value")},window&&window.localStorage&&window.localStorage.clear&&e.Object.some(window.localStorage,function(e,t){return t.indexOf("curator-photo-metadata")>-1?(window.localStorage.clear(),!0):!1}),this.savePhotoMetadata("curator-photo-form-state",e.JSON.stringify(s)),n.photos.photo.length>0&&this.appContext.callAPI("flickr.licensing.curation.addPhotos",{json:e.JSON.stringify(n)}).then(function(){o.isModalOpen=!1,o.modal.close(),o.updateStatus(),o.modal=null},function(){o.isModalOpen=!1,o.modal.close(),o.modal=null,console.error("flickr.licensing.curation.addPhotos error",arguments)})},savePhotoMetadata:function(t,n){try{return e.StorageHelper.setItem(t,n),!0}catch(r){return!1}},getPhotoMetadata:function(t){try{return e.StorageHelper.getItem(t)}catch(n){return!1}}},{ATTRS:{}})},"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","fluid-modal-view","fluid-css","products-form-css","products-new-payment-form-css","curator-tools-css","curation-photomappings-model","hermes-template-curator-tool-photo-metadata-form"],optional:[]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("yui-throttle",function(e,t){
/*! Based on work by Simon Willison: http://gist.github.com/292562 */
;e.throttle=function(t,n){n=n?n:e.config.throttleTime||150;if(n===-1)return function(){t.apply(this,arguments)};var r=e.Lang.now();return function(){var i=e.Lang.now();i-r>n&&(r=i,t.apply(this,arguments))}}},"3.16.0",{requires:["yui-base"]});
YUI.add("hermes-template-photo-well-scrappy",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return" enable-zoom"}function d(e,t){return" no-click"}function v(e,t){return" is-hidden"}function m(e,t){var r;return(r=n["prev-url"])?r=r.call(e,{hash:{},data:t}):(r=e["prev-url"],r=typeof r===f?r.apply(e):r),l(r)}function g(e,t){return"#"}function y(e,t){var r;return(r=n["next-url"])?r=r.call(e,{hash:{},data:t}):(r=e["next-url"],r=typeof r===f?r.apply(e):r),l(r)}function b(e,t){var r="",i,s;return r+="\n		",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["photo-sidebar-toggle-view"],s):c.call(e,"outlet",e["photo-sidebar-toggle-view"],s)))+"\n		",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["photo-title-desc-overlay-view"],s):c.call(e,"outlet",e["photo-title-desc-overlay-view"],s)))+"\n		",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["photo-sidebar-actions-view"],s):c.call(e,"outlet",e["photo-sidebar-actions-view"],s)))+"\n		",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["attribution-view"],s):c.call(e,"outlet",e["attribution-view"],s)))+"\n		",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["people-notes-view"],s):c.call(e,"outlet",e["people-notes-view"],s)))+"\n		",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["photo-engagement-view"],s):c.call(e,"outlet",e["photo-engagement-view"],s)))+"\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;s+='<div class="height-controller',o=n["if"].call(t,t.enableZoom,{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(o||o===0)s+=o;s+='" style="height: ',(o=n.height)?o=o.call(t,{hash:{},data:i}):(o=t.height,o=typeof o===f?o.apply(t):o),s+=l(o)+'px;">\n\n	<a class="navigate-target navigate-prev',o=n["if"].call(t,t["prev-is-not-clickable"],{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(o||o===0)s+=o;o=n["if"].call(t,t["is-hidden"],{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(o||o===0)s+=o;s+='" href="',o=n["if"].call(t,t["prev-url"],{hash:{},inverse:h.program(9,g,i),fn:h.program(7,m,i),data:i});if(o||o===0)s+=o;s+='" data-track="prevPhotoButtonClick" data-action="ad" style="height: ',(o=n.navHeight)?o=o.call(t,{hash:{},data:i}):(o=t.navHeight,o=typeof o===f?o.apply(t):o),s+=l(o)+'px;"><span class="hide-text">&larr;</span></a>\n\n	',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["photo-well-media-view"],a):c.call(t,"outlet",t["photo-well-media-view"],a)))+"\n	",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["photo-notes-scrappy-view"],a):c.call(t,"outlet",t["photo-notes-scrappy-view"],a)))+'\n\n	<a class="navigate-target navigate-next',u=n["if"].call(t,t["next-is-not-clickable"],{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,t["is-hidden"],{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+='" href="',u=n["if"].call(t,t["next-url"],{hash:{},inverse:h.program(9,g,i),fn:h.program(11,y,i),data:i});if(u||u===0)s+=u;s+='" data-track="nextPhotoButtonClick" data-action="ad" style="height: ',(u=n.navHeight)?u=u.call(t,{hash:{},data:i}):(u=t.navHeight,u=typeof u===f?u.apply(t):u),s+=l(u)+'px;"><span class="hide-text">&rarr;</span></a>\n\n	',u=n.unless.call(t,t["is-ad"],{hash:{},inverse:h.noop,fn:h.program(13,b,i),data:i});if(u||u===0)s+=u;return s+="\n\n	<a class='entry-type' href='",(u=n.entryURL)?u=u.call(t,{hash:{},data:i}):(u=t.entryURL,u=typeof u===f?u.apply(t):u),s+=l(u)+"'>",(u=n.backToLabel)?u=u.call(t,{hash:{},data:i}):(u=t.backToLabel,u=typeof u===f?u.apply(t):u),s+=l(u)+"</a>\n\n	",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["context-slider-view"],a):c.call(t,"outlet",t["context-slider-view"],a)))+"\n\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-scrappy",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("flickr-video-player",function(e){var t={playlistUrl:e.url("/video_playlist.gne",{protocol:!1}),lang:e.config.lang,comscoreC4:"",defaultResolution:"1080p",atlas:{maxBitrate:4e3,domain:"video.yahoo.com"},css:{processing:"processing"},messages:{processing:"This video is being processed"}};e.FlickrVideoPlayer=function(e){this.container=e.container,this.model=e.model,this.appContext=e.appContext,this.currentStream=null},e.FlickrVideoPlayer.prototype={render:function(){var n,r,i=this;this.setCurrentStream(t.defaultResolution,"noop"),i.appContext.flipper.isFlipped("enable-nextgen-videoplayer")?n={playlist:{mediaItems:[{images:i.getThumbnails(),streams:[{url:this.currentStream.url}]}]},pageSpaceId:this.appContext.flapp.get("activeView").get("spaceid").toString(),comscoreC4:"flickr",settingscreen:!1,pausescreen:!1,html5:!0}:(n={playlist:{mediaItems:[]},pageSpaceId:this.appContext.flapp.get("activeView").get("spaceid"),comscoreC4:t.comscoreC4,lang:t.lang,autoplay:!1},n.playlist.mediaItems.push(this.toMediaItem(this.currentStream))),n.region="US",n.site="flickr",this.player=new e.VideoPlatform.VideoPlayer(n),this.player.render(this.container),r=e.VideoPlatform.API_Events,this.player.on(r.PLAYER_ERROR,function(e){var t;i.appContext.flipper.isFlipped("enable-nextgen-videoplayer")?t=i.container.one(".yvp-content"):t=i.container.one(".yui3-videoplayer-content"),i.appContext.error("[video-player] "+e.type+": "+(e.message||"no message"));if(i.__retry){t.removeClass("retrying");return}i.__retry=!0,t.addClass("retrying"),i.loadStreams().then(function(){i.setCurrentStream(i.currentStream.resolution),i.play()})}),this.player.on(r.PLAYBACK_ERROR,function(e){i.appContext.error("[video-player] "+e.type+": "+(e.message||"no message"))})},hasHdStream:function(){return this.streams["1080p"]||this.streams["720p"]||this.streams.appletv},isHdStream:function(e){return["1080p","720p","appletv"].indexOf(this.currentStream.resolution)>=0},play:function(){this.player.controls.play()},pause:function(){this.player.controls.pause()},resize:function(e,t){this.container.setStyles({width:e+"px",height:t+"px"})},setCurrentStream:function(e,t){this.currentStream&&this.quality&&this.quality.removeClass("q"+this.currentStream.resolution),this.currentStream=this.getStream(e),this.quality&&this.quality.addClass("q"+this.currentStream.resolution);if(t)return;this.player.playlist.clear(),this.player.playlist.addItem(this.toMediaItem(this.currentStream)),this.player.playlist.setPosition(0)},toMediaItem:function(e){return{streamUrl:e.url,images:this.getThumbnails()}},init:function(){var t,n=this;return t=new e.FlickrPromise({script:this.loadScript(),streams:this.loadStreams(),domLive:this._waitDomLive()}),t.then(function(e){n.render()})},_waitDomLive:function(){var t=this.container.getDOMNode().parentElement;return new e.Promise(function(e,n){var r=50,i;i=function(){var n=t.parentElement;while(n&&n!==document.body)n=n.parentElement;if(n)return e();if(r--<0)return;setTimeout(i,100)},i()})},getStream:function(e){var t,n,r;t=["1080p","720p","appletv","360p","700","300","100","iphone_wifi","288p"],e&&(r=t.indexOf(e),t=r>0?t.slice(r):t);while(t.length){n=this.streams[t.shift()];if(n)return n}return{}},getThumbnails:function(){var e,t;return t={width:parseInt(this.container.getComputedStyle("width"),10)||800,height:parseInt(this.container.getComputedStyle("height"),10)||600},e=this.model.getSizeToFit(t,{excludeSizes:[]}),{large:e.url,medium:e.url,small:e.url}},loadScript:function(){var n=this;return new e.Promise(function(r,i){var s,o;if(e.VideoPlatform){r();return}o=function(){e.use("videoplayer",r)},n.appContext.flipper.isFlipped("enable-nextgen-videoplayer")?(t.yepSourceUrl="//yep.video.yahoo.com/js/3/videoplayer-min.js?r=nextgen-flash",t.yepMobileSourceUrl="//yep.video.yahoo.com/js/3/videoplayer-min.js?r=nextgen"):t.yepSourceUrl="//yep.video.yahoo.com/js/3/videoplayer-min.js?lang="+t.lang,s=document.createElement("script"),s.onload=o,e.UA&&e.UA.mobile&&t.yepMobileSourceUrl?s.src=t.yepMobileSourceUrl:s.src=t.yepSourceUrl,document.head.appendChild(s)})},loadStreams:function(){var t=this;return new e.Promise(function(e,n){var r;r={photo_id:t.model.getValue("id"),secret:t.model.getValue("secret")},t.appContext.callAPI("flickr.video.getStreamInfo",r).then(function(n){try{t.streams=n.streams.stream.reduce(function(e,t){var n=t.type+"";return e[n]={resolution:n,url:t.content},e},{})}catch(r){t.streams={}}Object.keys(t.streams).length||t.appContext.error("[video-player] no streams available"),e()},function(e){if(e&&e.code&&e.code.toString()==="1")return t.setProcessing();t.appContext.error("[video-player] error fetching playlist")})})},loadXmlStreams:function(){var n=this;return new e.Promise(function(r,i){var s,o;s={nsid:n.model.getValue("owner").getValue("nsid"),video_id:n.model.getValue("id"),bitrate:t.atlas.maxBitrate,secret:n.model.getValue("secret"),rd:t.atlas.domain,noad:1},o=new XMLHttpRequest,o.open("GET",e.flutil.buildHttpQuery(t.playlistUrl,s)),o.onload=function(){var e,t,i;e=document.createElement("div"),e.innerHTML=o.responseText,i=e.getElementsByTagName("duration")[0],i=i?parseInt(i.textContent,10):0,t=Array.prototype.slice.call(e.getElementsByTagName("stream")),n.streams=t.reduce(function(e,t){var n=Array.prototype.reduce.call(t.attributes,function(e,t){return e[t.name]=t.value,e},{});return n.url=n.app+n.fullpath,n.resolution=(n.path.match(/_([^\.\_]+)\./)||[])[1],n.duration=i,e[n.resolution]=n,e},{}),Object.keys(n.streams).length||n.appContext.error("[video-player] no streams available"),r()},o.onerror=function(){n.appContext.error('[video-player] error fetching playlist XML "'+e.flutil.buildHttpQuery(t.playlistUrl,s)+'"')},o.send()})},_cleanup:function(e){e=e.getDOMNode();var t=function(e){if(!e.firstChild)return;while(e.firstChild)t(e.firstChild),e.removeChild(e.firstChild)};t(e)},setProcessing:function(){var t=e.Node.create("<img/>");t.set("src",this.getThumbnails().large),this.container.appendChild(t)},destroy:function(
){this.player&&this.player.destroy(),this.player=null,this.quality&&this.quality.detach(),this.quality=null,this._cleanup(this.container),this.container=null,this.model=null,this.appContext=null,this.streams=null}}},"@VERSION@",{requires:["flickr-promise","flutil","flickr-video-player-css","url"],optional:[]});
YUI.add("hermes-template-zoom",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{}}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/zoom",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-zoom-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i;return r+='<img src="',(i=n.smallSrc)?i=i.call(e,{hash:{},data:t}):(i=e.smallSrc,i=typeof i===u?i.apply(e):i),r+=a(i)+'" class="zoom-small">',r}function c(e,t){var r="",i;return r+='<img src="',(i=n.largeSrc)?i=i.call(e,{hash:{},data:t}):(i=e.largeSrc,i=typeof i===u?i.apply(e):i),r+=a(i)+'" class="zoom-large">',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="zoom-modal hidden">\n	<div class="zoom-photo-container">\n		',o=n["if"].call(t,t.smallSrc,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n		",o=n["if"].call(t,t.largeSrc,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;return s+='\n		<span class="facade-of-protection-zoom"></span>\n	</div>\n</div>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/zoom-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("animation-manager",function(e){e.AnimationManager=function(){function i(){return n=!1,r=[],!YUI.Env.isServer&&!e.config.win.requestAnimationFrame&&s(),{subscribe:u}}function s(){var t=["webkit","moz"],n,r,i=0;for(r=0;r<t.length&&!e.config.win.requestAnimationFrame;++r)n=t[r],e.config.win.requestAnimationFrame=e.config.win[n+"RequestAnimationFrame"],e.config.win.cancelAnimationFrame=e.config.win[n+"CancelAnimationFrame"]||e.config.win[n+"CancelRequestAnimationFrame"];if(!e.config.win.requestAnimationFrame||!e.config.win.cancelAnimationFrame)e.config.win.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(i+16,t);return setTimeout(function(){e(i=n)},n-t)},e.config.win.cancelAnimationFrame=clearTimeout}function o(){if(!n)return;r.forEach(function(e,t){e()}),e.config.win.requestAnimationFrame(o)}function u(t){return r.push(t),n||(n=!0,e.config.win.requestAnimationFrame(o)),{detach:function(){r.splice(r.indexOf(t),1),r.length||(n=!1)}}}var t,n,r;return t||(t=i()),t}()},"@VERSION@",{requires:[]});
YUI.add("zoom-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,forceGpu:null,initializer:function(t){return this.photoId=t.photoId,this.disableIfSmall=!!t.disableIfSmall,YUI.Env.isServer||(e.config.win.location.search.indexOf("gpu=on")>-1?this.forceGpu=!0:e.config.win.location.search.indexOf("gpu=off")>-1&&(this.forceGpu=!1)),this},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){var e=this.templates("zoom")({})||"";return this.setContainerHTML(e),this},activate:function(){var t=this,n=t.getZoomKeyScope();return this.get("photo").getValue("needsInterstitial")||(this.parentViewContainer=this.get("container").ancestor(".view"),t.registerEventHandler(t.get("container").on("click",function(n){n.preventDefault(),t.cursorCoords=[n.pageX-e.config.win.pageXOffset,n.pageY-e.config.win.pageYOffset],e.rapidTracker.beacon(t.name,"zoomInClick"),t.zoomIn(t.cursorCoords)})),t.attachKeyEvent("down:90",e.betterThrottle(function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"zoomInKeyPress"),t.zoomIn()},100)),t.attachKeyEvent("down:90,27",e.betterThrottle(function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"zoomOutKeyPress"),t.zoomOut()},100),n),t.attachKeyEvent("down:37,38,39,40",e.betterThrottle(function(n){var r=[t.currentZoomRegion.left,t.currentZoomRegion.top],i=200;n.preventDefault();switch(n.button){case 37:r[0]+=i;break;case 38:r[1]+=i;break;case 39:r[0]-=i;break;case 40:r[1]-=i}e.rapidTracker.beacon(t.name,"zoomPanKeyPress"),t.panZoomNode(r)},16),n),t.registerEventHandler(t.appContext.flapp.before("activeViewChange",function(e){t.cleanUp()}))),this},getZoomEdgeMargin:function(){return 100},panZoomNodeToCurrentCoords:function(){if(!this.zoomedIn)return;var e=this.cursorCoords,t=this.getZoomPanCoordsForCursor(e);if(!t)return;this.panZoomNode(t)},panZoomNode:function(e){if(this.currentZoomRegion.left===e[0]&&this.currentZoomRegion.top===e[1])return;e=this.constrainPanCoords(e),this.currentZoomRegion.left=e[0],this.currentZoomRegion.top=e[1],this.pendingCoords=e},constrainPanCoords:function(e){var t,n,r,i,s=this.getZoomEdgeMargin(),o=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],u=[this.zoomImageFullWidth,this.zoomImageFullHeight],a=[u[0]+2*s,u[1]+2*s];return t=0,n=o[0]-u[0]-2*s,r=0,i=o[1]-u[1]-2*s,e[0]>t?e[0]=t:e[0]<n&&(e[0]=n),e[1]>r?e[1]=r:e[1]<i&&(e[1]=i),u[0]<o[0]&&(e[0]=.5*(o[0]-a[0])),u[1]<o[1]&&(e[1]=.5*(o[1]-a[1])),e},getZoomPanCoordsForCursor:function(e){if(!e)return;var t=this.getZoomEdgeMargin(),n=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],r=[this.zoomImageFullWidth,this.zoomImageFullHeight],i=[r[0]+2*t,r[1]+2*t],s=[e[0]/n[0],e[1]/n[1]],o=[s[0]*(n[0]-i[0]),s[1]*(n[1]-i[1])];return o},getZoomSmallRegion:function(){var t=this.get("container");return{left:t.getX()-e.config.win.pageXOffset-this.getZoomEdgeMargin(),top:t.getY()-e.config.win.pageYOffset-this.getZoomEdgeMargin(),width:parseInt(t.getStyle("width"),10),height:parseInt(t.getStyle("height"),10)}},resizeZoomNode:function(t,n){var r=this,i,s,o=e.config.win.performance&&e.config.win.performance.now;return n?new e.Promise(function(n,u){function a(e){var u=o?e-i:Date.now()-i,a=u/r.getZoomTransitionTime(),f;return a>=1?(f=t,r.isAnimatingZoom=!1,setTimeout(function(){n()},r.getZoomTransitionTime())):f={left:s.left+(t.left-s.left)*a,top:s.top+(t.top-s.top)*a,width:s.width+(t.width-s.width)*a,height:s.height+(t.height-s.height)*a},f}function f(n){var i=a(n);if(r.zoomingIn||r.zoomingOut)r.resizeZoomNode(i,!1),i!==t&&e.config.win.requestAnimationFrame(f)}r.isAnimatingZoom=!0,i=o?e.config.win.performance.now():Date.now(),s=r.currentZoomRegion,e.config.win.requestAnimationFrame(f)}):(this.currentZoomRegion=t,this.zoomPhotoContainerNode&&this.zoomPhotoContainerNode.setStyle("transform","translate("+t.left+"px, "+t.top+"px) scale("+t.width/this.zoomImageFullWidth+")"),e.Promise.resolve())},getZoomTransitionTime:function(){return 200},zoomOut:function(){var t=this,n=this.zoomNode;e.fire("flickr:removeKeyEventScope",this.getZoomKeyScope()),n.detachAll("mousemove"),this.mouseWheelHandler&&this.mouseWheelHandler.detach(),this.touchHandlers&&(this.touchHandlers.forEach(function(e){e.detach()}),delete this.touchHandlers),this.resizeZoomNode(this.getZoomSmallRegion(),!0),n.addClass("hiding"),this.zoomedIn=!1,this.zoomingIn=!1,this.zoomingOut=!0,setTimeout(function(){t.zoomingOut&&n&&n._node&&(t.parentViewContainer.removeClass("zoomed"),n.removeClass("hiding"),n.addClass("hidden"),setTimeout(function(){t.zoomingOut&&(t.cleanUp(),this.zoomingOut=!1)},200))},this.getZoomTransitionTime()+0),delete this.pendingCoords,delete this.currentCoords},cleanUp:function(){this.zoomNode&&(this.zoomNode.remove(!0),delete this.zoomNode,delete this.zoomPhotoContainerNode,this.zoomAnimationHandle.detach())},isImageReadyToDisplay:function(e){var t;return e?(t=new Image,t.src=e,t.complete||t.naturalWidth):!1},getZoomKeyScope:function(){return this.name+this._yuid},zoomMouseMoveHandler:function(t){this.cursorCoords=[t.pageX-e.config.win.pageXOffset,t.pageY-e.config.win.pageYOffset],this.isAnimatingZoom||this.panZoomNodeToCurrentCoords()},zoomScrollWheelHandler:function(e){e.preventDefault();var t=e.wheelDeltaX,n=e.wheelDeltaY;t===undefined&&(t=-e.deltaX||0),n===undefined&&(n=-e.deltaY||0),this.panZoomNode([this.currentZoomRegion.left+t,this.currentZoomRegion.top+n])},getSizes:function(){var e=this.parentViewContainer.one(".low-res-photo"),t=this.parentViewContainer.one(".main-photo");return{small:e?e.getAttribute("src"):"",medium:t?t.getAttribute("src"):"",large:this.getLargestSize()}},getLargestSize:function(){var e=this.appContext.flipper.isFlipped("enable-zoom-proxy"),t=this.appContext.flipper.config["zoom-proxy-prefix"],n;return e&&t?(n=this.get("photo").getLargestSize({excludeSizes:[]}),n.key==="o"&&(console.log("proxyPrefix",t,"largestSize.displayUrl"
,n.displayUrl),n.displayUrl=n.url=t+"http:"+n.displayUrl,console.log("proxying original",n.url))):n=this.get("photo").getLargestSize(),n},zoomIn:function(t){var n=this,r,i,s=this.getSizes(),o=this.isImageReadyToDisplay(s.medium),u=this.isImageReadyToDisplay(s.large.url),a=this.getZoomPixelRatio(),f=this.getZoomSmallRegion(),l,c,h,p=this.maxMsgNode;if(this.disableIfSmall&&f.width>=s.large.width){p||(p=this.maxMsgNode=e.Node.create('<div class="zoom-max-message">'+n.intlMessage({intlName:"photo-page-scrappy.ZOOM_MAX_MESSAGE"})+"</div>")),this.get("container").contains(p)||(p.addClass("hidden"),this.get("container").append(p)),setTimeout(function(){p&&p.inDoc()&&(p.removeClass("hidden"),this.maxMsgNodeHidingTimer&&(clearTimeout(this.maxMsgNodeHidingTimer),delete this.maxMsgNodeHidingTimer),this.maxMsgNodeHidingTimer=setTimeout(function(){p&&p.inDoc()&&p.addClass("hidden")},3e3))},0);return}e.fire("flickr:setKeyEventScope",this.getZoomKeyScope()),this.zoomingIn=!0,this.zoomAnimationHandle=e.AnimationManager.subscribe(function(){var r=n.getDeteriorationRateForEasing(),i,s,o={x:0,y:0},u={x:0,y:0},a={x:0,y:0};if(n.pendingCoords){o.x=parseInt(n.pendingCoords[0],10),o.y=parseInt(n.pendingCoords[1],10),n.currentCoords?(u.x=n.currentCoords[0],u.y=n.currentCoords[1]):(i=n.getZoomPanCoordsForCursor(t),s=n.constrainPanCoords(i),u.x=parseInt(s[0],10),u.y=parseInt(s[1],10)),o.x<u.x?a.x=u.x-Math.abs(o.x-u.x)*r:a.x=u.x+Math.abs(o.x-u.x)*r,o.y<u.y?a.y=u.y-Math.abs(o.y-u.y)*r:a.y=u.y+Math.abs(o.y-u.y)*r,a.x=parseInt(a.x,10),a.y=parseInt(a.y,10),a.x===u.x&&(o.x<u.x?a.x=u.x-1:o.x>u.x&&(a.x=u.x+1)),a.y===u.y&&(o.y<u.y?a.y=u.y-1:o.y>u.y&&(a.y=u.y+1));if(a.x!==o.x||a.y!==o.y)(n.forceGpu===!0||e.config.win.devicePixelRatio>1)&&n.forceGpu!==!1?n.zoomPhotoContainerNode.setStyle("transform","translate3d("+a.x+"px, "+a.y+"px, 0)"):n.zoomPhotoContainerNode.setStyle("transform","translate("+a.x+"px, "+a.y+"px)");n.currentCoords=[a.x,a.y],a.x===o.x&&a.y===o.y&&delete n.pendingCoords}}),this.zoomNode?(this.zoomingOut=!1,r=this.zoomNode,r.removeClass("hiding"),r.detachAll("mousemove"),this.mouseWheelHandler&&this.mouseWheelHandler.detach(),this.touchHandlers&&(this.touchHandlers.forEach(function(e){e.detach()}),delete this.touchHandlers)):r=this.zoomNode=e.Node.create(this.templates("zoom-modal")({smallSrc:o?s.medium:s.small,largeSrc:u?s.large.url:""})),i=this.zoomPhotoContainerNode=r.one(".zoom-photo-container"),this.zoomImageFullWidth=s.large.width/a,this.zoomImageFullHeight=s.large.height/a,t||(t=[this.appContext.viewportData.viewport.width/2,this.appContext.viewportData.viewport.height/2],n.cursorCoords=t),l=this.getZoomPanCoordsForCursor(t),l=this.constrainPanCoords(l),c={left:l[0],top:l[1],width:this.zoomImageFullWidth,height:this.zoomImageFullHeight},i.setStyle("transition","none"),this.resizeZoomNode(f,!1),r.on("click",function(t){if(n.zoomingIn)return;t.preventDefault(),e.rapidTracker.beacon(n.name,"zoomOutClick"),n.zoomOut()}),e.one("body").append(r),i.setStyle("width",c.width),i.setStyle("height",c.height),e.soon(function(){n.zoomingIn&&(r.removeClass("hidden"),i.setStyle("transition",""),"ontouchstart"in document?e.use("event-touch",function(){n.touchHandlers=[],n.touchHandlers.push(e.on("touchstart",function(e){e.changedTouches.length&&e.changedTouches.length===1&&(n.touching=[e.changedTouches[0].pageX,e.changedTouches[0].pageY])})),n.touchHandlers.push(e.on("touchmove",function(e){var t=e.pageX,r=e.pageY,i,s;n.touching&&e.changedTouches.length&&e.changedTouches.length===1&&(t=e.changedTouches[0].pageX,r=e.changedTouches[0].pageY,e.preventDefault(),i=t-n.touching[0],s=r-n.touching[1],n.touching=[t,r],n.panZoomNode([n.currentZoomRegion.left+i,n.currentZoomRegion.top+s]))})),n.touchHandlers.push(e.on("touchend",function(e){delete n.touching}))}):(r.on("mousemove",n.zoomMouseMoveHandler.bind(n)),n.mouseWheelHandler=function(){var e=n.zoomScrollWheelHandler.bind(n);return h="onwheel"in document.createElement("div")?"wheel":"mousewheel",document.addEventListener(h,e,!1),{detach:function(){document.removeEventListener(h,e,!1)}}}()),n.parentViewContainer.addClass("zoomed"),n.resizeZoomNode(c,!0).then(function(){n.zoomingIn&&(n.zoomingIn=!1,n.zoomedIn=!0,n.panZoomNodeToCurrentCoords(),u||i.append('<img src="'+s.large.url+'" class="zoom-large">'))}))})},getDeteriorationRateForEasing:function(){return.2},getZoomPixelRatio:function(){return 1}})},"@VERSION@",{requires:["flickr-view","better-throttle","flickr-promise","zoom-css","hermes-template-zoom","hermes-template-zoom-modal","animation-manager"],optional:["photo-models"],langBundles:["photo-page-scrappy"]});
